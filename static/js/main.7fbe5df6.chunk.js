(this["webpackJsonpshare-my-cart"]=this["webpackJsonpshare-my-cart"]||[]).push([[6],{101:function(e,t,n){var r={"./ion-action-sheet-ios.entry.js":[147,67],"./ion-action-sheet-md.entry.js":[148,68],"./ion-alert-ios.entry.js":[149,59],"./ion-alert-md.entry.js":[150,60],"./ion-app_8-ios.entry.js":[151,53],"./ion-app_8-md.entry.js":[152,54],"./ion-avatar_3-ios.entry.js":[153,8],"./ion-avatar_3-md.entry.js":[154,9],"./ion-back-button-ios.entry.js":[155,10],"./ion-back-button-md.entry.js":[156,11],"./ion-backdrop-ios.entry.js":[157,12],"./ion-backdrop-md.entry.js":[158,13],"./ion-button_2-ios.entry.js":[159,69],"./ion-button_2-md.entry.js":[160,70],"./ion-card_5-ios.entry.js":[161,14],"./ion-card_5-md.entry.js":[162,15],"./ion-checkbox-ios.entry.js":[163,16],"./ion-checkbox-md.entry.js":[164,17],"./ion-chip-ios.entry.js":[165,18],"./ion-chip-md.entry.js":[166,19],"./ion-col_3.entry.js":[167,20],"./ion-datetime_3-ios.entry.js":[168,57],"./ion-datetime_3-md.entry.js":[169,58],"./ion-fab_3-ios.entry.js":[170,21],"./ion-fab_3-md.entry.js":[171,22],"./ion-img.entry.js":[172,23],"./ion-infinite-scroll_2-ios.entry.js":[173,24],"./ion-infinite-scroll_2-md.entry.js":[174,25],"./ion-input-ios.entry.js":[175,26],"./ion-input-md.entry.js":[176,27],"./ion-item-option_3-ios.entry.js":[177,71],"./ion-item-option_3-md.entry.js":[178,72],"./ion-item_8-ios.entry.js":[179,73],"./ion-item_8-md.entry.js":[180,74],"./ion-loading-ios.entry.js":[181,28],"./ion-loading-md.entry.js":[182,29],"./ion-menu_3-ios.entry.js":[183,75],"./ion-menu_3-md.entry.js":[184,76],"./ion-modal-ios.entry.js":[185,55],"./ion-modal-md.entry.js":[186,56],"./ion-nav_2.entry.js":[187,66],"./ion-popover-ios.entry.js":[188,30],"./ion-popover-md.entry.js":[189,31],"./ion-progress-bar-ios.entry.js":[190,32],"./ion-progress-bar-md.entry.js":[191,33],"./ion-radio_2-ios.entry.js":[192,34],"./ion-radio_2-md.entry.js":[193,35],"./ion-range-ios.entry.js":[194,77],"./ion-range-md.entry.js":[195,78],"./ion-refresher_2-ios.entry.js":[196,61],"./ion-refresher_2-md.entry.js":[197,62],"./ion-reorder_2-ios.entry.js":[198,36],"./ion-reorder_2-md.entry.js":[199,37],"./ion-ripple-effect.entry.js":[200,38],"./ion-route_4.entry.js":[201,79],"./ion-searchbar-ios.entry.js":[202,80],"./ion-searchbar-md.entry.js":[203,81],"./ion-segment_2-ios.entry.js":[204,82],"./ion-segment_2-md.entry.js":[205,83],"./ion-select_3-ios.entry.js":[206,84],"./ion-select_3-md.entry.js":[207,85],"./ion-slide_2-ios.entry.js":[208,86],"./ion-slide_2-md.entry.js":[209,87],"./ion-spinner.entry.js":[210,39],"./ion-split-pane-ios.entry.js":[211,40],"./ion-split-pane-md.entry.js":[212,41],"./ion-tab-bar_2-ios.entry.js":[213,42],"./ion-tab-bar_2-md.entry.js":[214,43],"./ion-tab_2.entry.js":[215,44],"./ion-text.entry.js":[216,45],"./ion-textarea-ios.entry.js":[217,46],"./ion-textarea-md.entry.js":[218,47],"./ion-toast-ios.entry.js":[219,63],"./ion-toast-md.entry.js":[220,64],"./ion-toggle-ios.entry.js":[221,48],"./ion-toggle-md.entry.js":[222,49],"./ion-virtual-scroll.entry.js":[223,50]};function i(e){if(!n.o(r,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=r[e],i=t[0];return n.e(t[1]).then((function(){return n(i)}))}i.keys=function(){return Object.keys(r)},i.id=101,e.exports=i},103:function(e,t,n){var r={"./ion-icon.entry.js":[227,90]};function i(e){if(!n.o(r,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=r[e],i=t[0];return n.e(t[1]).then((function(){return n(i)}))}i.keys=function(){return Object.keys(r)},i.id=103,e.exports=i},124:function(e,t,n){},127:function(e,t,n){},128:function(e,t,n){},132:function(e,t,n){},143:function(e,t,n){},144:function(e,t,n){},145:function(e,t,n){},146:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n.n(r),a=n(36),s=n.n(a),o=n(7),c=n(62),l=n.n(c),u=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function p(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var d=n(3),m=n(9),h=function e(t){var n=this;Object(d.a)(this,e),this.authUser=null,this.dbAuthenticated=!1,this.setAuthUser=function(e){n.authUser=e},this.setDbAuthenticated=function(e){return n.dbAuthenticated=e},this.rootStore=t};Object(m.h)(h,{authUser:m.m,dbAuthenticated:m.m,setAuthUser:m.d,setDbAuthenticated:m.d});var f=h,g=n(12),b=n(4),E=n(15),S=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"uid",n={};return e.reduce((function(e,n){return Object(g.a)({},e,Object(E.a)({},n[t],n))}),n)},y=function(){function e(t){var n=this;Object(d.a)(this,e),this.users={},this.setUsers=function(e){n.users=S(e)},this.setUser=function(e,t){n.users||(n.users={}),n.users[e]=t},this.rootStore=t}return Object(b.a)(e,[{key:"userList",get:function(){var e=this;return Object.keys(this.users||{}).map((function(t){return Object(g.a)({},e.users[t],{uid:t})}))}}]),e}();Object(m.h)(y,{users:m.m,setUser:m.d,setUsers:m.d,userList:m.e});var v=y,L=function(e,t){return e.order&&t.order&&e.order!==t.order?e.order-t.order:e.order&&!t.order?e.order:!e.order&&t.order?-1*t.order:e.createdAt&&t.createdAt?t.createdAt.seconds-e.createdAt.seconds:e.createdAt?t.createdAt?0:1:-1},O=function(){function e(t){var n=this;Object(d.a)(this,e),this.shoppingLists=null,this.currentShoppingList=null,this.currentShoppingListItems=null,this.currentDependentNeedsLists=null,this.currentDependentNeedsListsItems=null,this.initializationDone=!1,this.setShoppingLists=function(e){n.shoppingLists=S(e);var t=e.filter((function(e){return!!e.isCurrent}));n.currentShoppingList=t.length>0&&t[0]||null},this.setCurrentShoppingListItems=function(e){n.currentShoppingListItems=S(e)},this.setCurrentDependentNeedsLists=function(e){n.currentDependentNeedsLists=S(e)},this.setDependentNeedsListItems=function(e,t){n.currentDependentNeedsLists[e].items=t},this.rootStore=t}return Object(b.a)(e,[{key:"setInitializationDone",value:function(e){this.initializationDone=e}},{key:"shoppingListsArray",get:function(){var e=this;return Object.keys(this.shoppingLists||{}).map((function(t){return Object(g.a)({},e.shoppingLists[t],{uid:e.shoppingLists[t].uid})}))}},{key:"currentShoppingListItemsArray",get:function(){var e=this;return Object.keys(this.currentShoppingListItems||{}).map((function(t){return Object(g.a)({},e.currentShoppingListItems[t],{uid:e.currentShoppingListItems[t].uid})})).sort((function(e,t){return L(e,t)}))}},{key:"currentDependentNeedsListsArray",get:function(){var e=this;return Object.keys(this.currentDependentNeedsLists||{}).filter((function(e){return"archived"!==e.lifecycleStatus})).map((function(t){return Object(g.a)({},e.currentDependentNeedsLists[t],{uid:e.currentDependentNeedsLists[t].uid})}))}},{key:"currentDependentNeedsListsItemsArray",get:function(){var e=this;if(!this.currentDependentNeedsLists)return[];var t=[];return Object.keys(this.currentDependentNeedsLists||{}).forEach((function(n){var r=e.currentDependentNeedsLists[n].items;if(r&&r.length){var i=e.currentDependentNeedsLists[n];t=t.concat(r.map((function(e){return Object.assign(Object(m.o)(e),{needsListId:Object(m.o)(i.uid),ownerId:Object(m.o)(i.userId)})})))}})),t}}]),e}();Object(m.h)(O,{shoppingLists:m.m,currentShoppingList:m.m,currentShoppingListItems:m.m,currentDependentNeedsLists:m.m,currentDependentNeedsListsItems:m.m,initializationDone:m.m,setInitializationDone:m.d,setShoppingLists:m.d,setCurrentShoppingListItems:m.d,setCurrentDependentNeedsLists:m.d,setDependentNeedsListItems:m.d,shoppingListsArray:m.e,currentShoppingListItemsArray:m.e,currentDependentNeedsListsArray:m.e,currentDependentNeedsListsItemsArray:m.e});var I=O,j=function(){function e(t){var n=this;Object(d.a)(this,e),this.needsLists=null,this.currentNeedsList=null,this.currentNeedsListItems=null,this.currentOriginShoppingList=null,this.currentOriginShoppingListItems=null,this.initializationDone=!1,this.setNeedsLists=function(e){n.needsLists=S(e);var t=e.filter((function(e){return!!e.isCurrent}));n.currentNeedsList=t.length>0&&t[0]||null},this.setCurrentNeedsListItems=function(e){n.currentNeedsListItems=S(e)},this.setCurrentOriginShoppingList=function(e){return n.currentOriginShoppingList=e},this.setCurrentOriginShoppingListItems=function(e){n.currentOriginShoppingListItems=S(e)},this.rootStore=t}return Object(b.a)(e,[{key:"setInitializationDone",value:function(e){this.initializationDone=e}},{key:"needsListsArray",get:function(){var e=this;return Object.keys(this.needsLists||{}).map((function(t){return Object(g.a)({},e.needsLists[t],{uid:e.needsLists[t].uid})}))}},{key:"currentNeedsListItemsArray",get:function(){var e=this;return Object.keys(this.currentNeedsListItems||{}).map((function(t){return Object(g.a)({},e.currentNeedsListItems[t],{uid:e.currentNeedsListItems[t].uid})})).sort((function(e,t){return L(e,t)}))}},{key:"potentiallyNeededItemsArray",get:function(){var e=this,t={};return Object.keys(this.currentNeedsListItems||{}).forEach((function(n){var r=e.currentNeedsListItems[n];t[r.name]=r})),Object.keys(this.currentOriginShoppingListItems||{}).map((function(t){return Object(g.a)({},e.currentOriginShoppingListItems[t],{uid:e.currentOriginShoppingListItems[t].uid})})).filter((function(e){return!t[e.name]})).sort((function(e,t){return L(e,t)}))}}]),e}();Object(m.h)(j,{needsLists:m.m,currentNeedsList:m.m,currentNeedsListItems:m.m,currentOriginShoppingList:m.m,currentOriginShoppingListItems:m.m,initializationDone:m.m,setInitializationDone:m.d,setNeedsLists:m.d,setCurrentNeedsListItems:m.d,setCurrentOriginShoppingList:m.d,setCurrentOriginShoppingListItems:m.d,needsListsArray:m.e,currentNeedsListItemsArray:m.e,potentiallyNeededItemsArray:m.e});var w=j,C=new function e(){Object(d.a)(this,e),this.sessionStore=new f(this),this.userStore=new v(this),this.shoppingStore=new I(this),this.needsStore=new w(this)},k=C,N=n(5),A=n(6),x=n(1),D=n(80),_=n(17),U=n(11),F=n(24),z=i.a.createContext({}),P=function(e){return function(t){return i.a.createElement(z.Consumer,null,(function(n){return i.a.createElement(e,Object.assign({},t,{firebase:n}))}))}},M=z,R=n(2),T=n.n(R),q=n(10),W=n(39),H=n.n(W),B=(n(109),n(111),{apiKey:"AIzaSyDGyWWNgTKBFCGrpM5LJChw3ri-Ly_3K7I",authDomain:"".concat("collabshop19",".firebaseapp.com"),databaseURL:"https://".concat("collabshop19",".firebaseio.com"),projectId:"".concat("collabshop19"),storageBucket:"".concat("collabshop19",".appspot.com"),emailRedirect:"https://beta.sharemycart.com"}),K=function e(){var t=this;Object(d.a)(this,e),this.doCreateUserWithEmailAndPassword=function(e,n){return t.auth.createUserWithEmailAndPassword(e,n)},this.doSignInWithEmailAndPassword=function(e,n){return t.auth.signInWithEmailAndPassword(e,n)},this.doSignInWithGoogle=function(){return t.auth.signInWithPopup(t.googleProvider)},this.doSignInWithFacebook=function(){return t.auth.signInWithPopup(t.facebookProvider)},this.doSignInWithTwitter=function(){return t.auth.signInWithPopup(t.twitterProvider)},this.doSignOut=function(){return t.auth.signOut()},this.doPasswordReset=function(e){return t.auth.sendPasswordResetEmail(e)},this.doSendEmailVerification=function(){return t.auth.currentUser.sendEmailVerification({url:B.emailRedirect})},this.doPasswordUpdate=function(e){return t.auth.currentUser.updatePassword(e)},this.onAuthUserListener=function(e,n){return t.auth.onAuthStateChanged((function(r){r?t.user(r.uid).get().then((function(t){var n=t.exists?t.data():{};n.roles||(n.roles={}),r=Object(g.a)({uid:r.uid,email:r.email,emailVerified:r.emailVerified,providerData:r.providerData},n),e(r)})):n()}))},this.user=function(e){return t.db.doc("users/".concat(e))},this.users=function(){return t.db.collection("users")},this.message=function(e){return t.db.doc("messages/".concat(e))},this.messages=function(){return t.db.collection("messages")},this.list=function(e){return t.db.doc("lists/".concat(e))},this.lists=function(){return t.db.collection("/lists")},this.myCurrentList=function(e){return t.db.collection("/lists").where("type","==",e).where("isCurrent","==",!0).where("userId","==",t.auth.currentUser?t.auth.currentUser.uid:"idonotexist")},this.createList=function(e,n){var r=e.name,i=void 0===r?"":r,a=e.allowCreateOwnNeeds,s=void 0===a||a;return t.lists().add({name:i,allowCreateOwnNeeds:s,type:n,userId:t.auth.currentUser.uid,isCurrent:!0,lifecycleStatus:"open",createdAt:t.fieldValue.serverTimestamp()})},this.editList=function(e,n){return t.list(e).set(Object.assign(n,{editedAt:t.fieldValue.serverTimestamp()}))},this.deleteList=function(){var e=Object(q.a)(T.a.mark((function e(n){var r,i;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.list(n).get();case 2:if(!(r=e.sent).exists){e.next=12;break}return i=r.data(),e.next=7,t.list(n).delete();case 7:if(!i.isCurrent){e.next=12;break}return e.next=10,t.lists().where("userId","==",i.userId).where("type","==",i.type).where("lifecycleStatus","==","open").limit(1).get();case 10:e.sent.docs.forEach((function(e){return e.ref.update("isCurrent",!0)}));case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.createListFromTemplate=function(){var e=Object(q.a)(T.a.mark((function e(n){var r,i,a=arguments;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=!(a.length>1&&void 0!==a[1])||a[1],e.next=3,t.createList({name:n.name},n.type);case 3:return i=e.sent,"shopping"===n.type?t.setCurrentShoppingList(i.id):t.setCurrentNeedsList(i.id),e.next=7,t.listItems(n.uid).get();case 7:return e.sent.forEach((function(e){var n=e.data();n.shopped&&r||(delete n.id,delete n.shopped,delete n.shoppedAt,delete n.shoppedBy,t.createItem(i.id,n))})),e.abrupt("return",i);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.listItems=function(e){return t.db.doc("lists/".concat(e)).collection("items")},this.listItem=function(e,n){return t.db.doc("lists/".concat(e)).collection("/items/").doc(n)},this.createItem=function(e,n){return t.listItems(e).add(Object.assign(n,{order:n.order||-1,createdAt:t.fieldValue.serverTimestamp()}))},this.editItem=function(e,n){return t.listItem(e,n.uid).set(Object.assign(n,{editedAt:t.fieldValue.serverTimestamp()}))},this.deleteItem=function(e,n){return t.listItem(e,n).delete()},this.setItemsOrder=function(e,n,r){var i=t.db.batch();n.forEach((function(n){return i.update(t.listItem(e,n.uid),"order",r[n.uid]||0)})),i.commit()},this.shopItem=function(e,n){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return t.listItem(e,n).update({shopped:r,shoppedBy:t.auth.currentUser.uid,shoppedAt:t.fieldValue.serverTimestamp(),editedAt:t.fieldValue.serverTimestamp()})},this.myCurrentShoppingList=function(){return t.myCurrentList("shopping")},this.myShoppingLists=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=["open","shopping","finished","archived"];return e&&n.push("archived"),t.lists().where("userId","==",t.auth.currentUser?t.auth.currentUser.uid:"idonotexist").where("type","==","shopping")},this.setCurrentShoppingList=function(e){t.myCurrentShoppingList().get().then((function(e){e.docs.forEach((function(e){return e.ref.update("isCurrent",!1)}))})).then((function(){return t.list(e).update("isCurrent",!0)}))},this.createShoppingList=function(){var e=Object(q.a)(T.a.mark((function e(n){var r;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.name,e.next=3,t.myCurrentShoppingList().get();case 3:return e.sent.docs.forEach((function(e){return e.ref.update("isCurrent",!1)})),e.abrupt("return",t.createList({name:r},"shopping"));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this._setShoppingListLifecycleStatusPropagating=function(){var e=Object(q.a)(T.a.mark((function e(n,r){var i;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(i=t.db.batch()).update(t.list(n),"lifecycleStatus",r),e.next=4,t.dependentNeedsListOfShoppingList(n).get();case 4:return e.sent.forEach((function(e){i.update(e.ref,"lifecycleStatus",r)})),e.abrupt("return",i.commit());case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),this.openShopping=function(){var e=Object(q.a)(T.a.mark((function e(n){return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"open"!==n.lifecycleStatus&&"archived"!==n.lifecycleStatus&&t._setShoppingListLifecycleStatusPropagating(n.uid,"open");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.goShopping=function(){var e=Object(q.a)(T.a.mark((function e(n){return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"shopping"!==n.lifecycleStatus&&"archived"!==n.lifecycleStatus&&t._setShoppingListLifecycleStatusPropagating(n.uid,"shopping");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.finishShopping=function(){var e=Object(q.a)(T.a.mark((function e(n){return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"finished"!==n.lifecycleStatus&&"archived"!==n.lifecycleStatus&&t._setShoppingListLifecycleStatusPropagating(n.uid,"finished");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.archiveShoppingList=function(){var e=Object(q.a)(T.a.mark((function e(n){return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"archived"!==n.lifecycleStatus&&t._setShoppingListLifecycleStatusPropagating(n.uid,"archived");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.myCurrentNeedsList=function(){return t.myCurrentList("needs")},this.setCurrentNeedsList=function(e){t.myCurrentNeedsList().get().then((function(e){e.docs.forEach((function(e){return e.ref.update("isCurrent",!1)}))})).then((function(){return t.list(e).update("isCurrent",!0)}))},this.createNeedsList=function(){var e=Object(q.a)(T.a.mark((function e(n){var r;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.name,e.next=3,t.myCurrentNeedsList().get();case 3:return e.sent.docs.forEach((function(e){return e.ref.update("isCurrent",!1)})),e.abrupt("return",t.createList({name:r},"needs"));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.archiveNeedsList=function(){var e=Object(q.a)(T.a.mark((function e(n){return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"archived"!==n.lifecycleStatus&&t.list(n.uid).update("lifecycleStatus","archived");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.myNeedsLists=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=["open","shopping","finished"];return e&&n.push("archived"),t.lists().where("userId","==",t.auth.currentUser?t.auth.currentUser.uid:"idonotexist").where("type","==","needs")},this.dependentNeedsListOfShoppingList=function(e){return t.lists().where("shoppingListId","==",e)},this.createNeedsListForShoppingList=function(e,n){return t.myCurrentNeedsList().get().then((function(t){t.size&&t.docs.forEach((function(t){t.data().shoppingListId!==e&&t.ref.update("isCurrent",!1)}))})),t.list(e).get().then((function(e){return e.data()})).then((function(r){t.myNeedsListsForShoppingList(e).then((function(i){i&&i.id?i.update("isCurrent",!0):t.lists().add({type:"needs",shoppingListId:e,shoppingListOwnerId:r.userId,isCurrent:!0,name:n,order:-1,userId:t.auth.currentUser.uid,lifecycleStatus:r.lifecycleStatus,createdAt:t.fieldValue.serverTimestamp()})}))}))},this.myNeedsListsForShoppingList=function(){var e=Object(q.a)(T.a.mark((function e(n){var r,i;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=null,i=t.myNeedsLists().where("shoppingListId","==",n).limit(1),e.next=4,i.get();case 4:return e.sent.docs.forEach((function(e){return r=e.ref,!1})),e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.addNeededItemFromShoppingListItem=function(e,n,r){var i=r.name,a=r.quantity,s=void 0===a?"":a,o=r.unit,c=void 0===o?"":o,l=n;return n.uid&&(l.originShoppingItemUid=n.uid),i&&(l.name=i),l.quantity=s,l.unit=c||"",delete l.createdAt,delete l.editedAt,delete l.uid,delete l.parentId,delete l.shopped,delete l.shoppedAt,delete l.shoppedBy,t.createItem(e,l)},H.a.initializeApp(B),this.fieldValue=H.a.firestore.FieldValue,this.emailAuthProvider=H.a.auth.EmailAuthProvider,this.auth=H.a.auth(),this.db=H.a.firestore(),this.auth.useDeviceLanguage(),this.googleProvider=new H.a.auth.GoogleAuthProvider,this.facebookProvider=new H.a.auth.FacebookAuthProvider,this.twitterProvider=new H.a.auth.TwitterAuthProvider},V="/shopping",G=n(229),J=n(230),Q=(n(61),function(e){return i.a.createElement(i.a.Fragment,null,i.a.createElement(x.v,{className:"image-login",src:"assets/icon/logo_512.png",style:{maxWidth:e.maxWidth}}),i.a.createElement(x.s,null,i.a.createElement(x.H,{className:"logo-text"},i.a.createElement(x.m,{className:"ion-align-self-center"},i.a.createElement(x.y,{style:{color:"#707070"}},e.textStart||"Share"),i.a.createElement(x.y,{style:{color:"#FA3D04"}},e.textEnd||"MyCart!")))))}),Z={username:"",email:"",passwordOne:"",isAdmin:!1,error:null},Y=function(e){Object(N.a)(n,e);var t=Object(A.a)(n);function n(e){var r;return Object(d.a)(this,n),(r=t.call(this,e)).onSubmit=function(e){var t=r.state,n=t.username,i=t.email,a=t.passwordOne,s={},o=(0,r.props.t)("Account_already_exists");r.props.firebase.doCreateUserWithEmailAndPassword(i,a).then((function(e){return r.props.firebase.user(e.user.uid).set({username:n,email:i,roles:s},{merge:!0})})).then((function(){return r.props.firebase.doSendEmailVerification()})).then((function(){r.setState(Object(g.a)({},Z));var e=r.props.location;!!(e.state&&e.state.from&&e.state.from.pathname.match("^/share/"))?r.props.history.push(e.state.from.pathname):r.props.history.push(V)})).catch((function(e){"auth/email-already-in-use"===e.code&&(e.message=o),r.setState({error:e})})),e.preventDefault()},r.onChange=function(e){r.setState(Object(E.a)({},e.target.name,e.target.value))},r.onChangeCheckbox=function(e){r.setState(Object(E.a)({},e.target.name,e.target.checked))},r.state=Object(g.a)({},Z),r}return Object(b.a)(n,[{key:"render",value:function(){var e=this.props.t,t=this.state,n=t.username,r=t.email,a=t.passwordOne,s=t.error,o=""===a||""===r||""===n;return i.a.createElement(i.a.Fragment,null,i.a.createElement("form",{onSubmit:this.onSubmit},i.a.createElement(x.H,null,i.a.createElement(x.m,null,i.a.createElement(x.w,{name:"username",value:n,type:"text",placeholder:e("Full Name"),onIonChange:this.onChange,clearInput:!0,className:"input","padding-horizontal":!0,"clear-input":"true",autocomplete:"name"}))),i.a.createElement(x.H,null,i.a.createElement(x.m,null,i.a.createElement(x.w,{name:"email",value:r,onIonChange:this.onChange,clearInput:!0,type:"email",placeholder:e("Email"),className:"input","padding-horizontal":!0,"clear-input":"true",autocomplete:"username email"}))),i.a.createElement(x.H,null,i.a.createElement(x.m,null,i.a.createElement(x.w,{clearInput:!0,name:"passwordOne",value:a,onIonChange:this.onChange,type:"password",placeholder:e("Password"),className:"input","padding-horizontal":!0,autocomplete:"new-password"}))),i.a.createElement(x.e,{disabled:o,type:"submit",expand:"block"},i.a.createElement(G.a,null,"Sign Up")),s&&i.a.createElement("p",null,s.message)))}}]),n}(r.Component),$=function(e){var t=e.state;return i.a.createElement("span",null,i.a.createElement(G.a,null,"No account yet?"),"\xa0",i.a.createElement(F.c,{to:{pathname:"/signup",state:t}},i.a.createElement(G.a,null,"Sign Up")))},X=Object(U.a)(_.i,P,Object(J.a)())(Y),ee=function(){return i.a.createElement(x.D,null,i.a.createElement(x.t,null,i.a.createElement(x.R,null,i.a.createElement(x.f,{slot:"secondary"},i.a.createElement(x.e,{fill:"clear"},i.a.createElement(G.a,null,"Help"))))),i.a.createElement(x.n,{className:"login-page"},i.a.createElement(Q,{maxWidth:"150px"}),i.a.createElement(X,null)))},te=n(8),ne=n(88),re=function(e){var t=e.defaultHref,n=Object(ne.a)().t;return i.a.createElement(x.d,{defaultHref:t,text:n("Back"),"data-test":"back"})},ie={email:"",error:null},ae=function(e){Object(N.a)(n,e);var t=Object(A.a)(n);function n(e){var r;return Object(d.a)(this,n),(r=t.call(this,e)).onSubmit=function(e){var t=r.state.email;r.props.firebase.doPasswordReset(t).then((function(){r.setState(Object(g.a)({},ie))})).catch((function(e){r.setState({error:e})})),e.preventDefault()},r.onChange=function(e){r.setState(Object(E.a)({},e.target.name,e.target.value))},r.state=Object(g.a)({},ie),r}return Object(b.a)(n,[{key:"render",value:function(){var e=this.state,t=e.email,n=e.error,r=""===t;return i.a.createElement("form",{onSubmit:this.onSubmit},i.a.createElement(x.H,null,i.a.createElement(x.m,null,i.a.createElement(x.w,{name:"email",value:t,onIonChange:this.onChange,clearInput:!0,type:"email",placeholder:"Email",class:"input","padding-horizontal":!0,"clear-input":"true"}))),i.a.createElement(x.e,{disabled:r,type:"submit",expand:"block"},i.a.createElement(G.a,null,"Reset My Password")),n&&i.a.createElement("p",null,n.message))}}]),n}(r.Component),se=function(){return i.a.createElement("span",null,i.a.createElement(F.c,{to:"/pw-forget"},i.a.createElement(G.a,null,"Forgot Password")))},oe=function(){return i.a.createElement(i.a.Fragment,null,i.a.createElement(x.t,null,i.a.createElement(x.R,null,i.a.createElement(x.f,{slot:"start"},i.a.createElement(re,{defaultHref:"/signin"})))),i.a.createElement(x.n,{className:"login-page"},i.a.createElement(Q,{maxWidth:"100px",textStart:"Forgot",textEnd:"MyPassword!"}),i.a.createElement(x.s,null,i.a.createElement(ce,null))))},ce=P(ae),le=(n(124),function(e){var t=function(t){Object(N.a)(r,t);var n=Object(A.a)(r);function r(e){var t;return Object(d.a)(this,r),(t=n.call(this,e)).props.sessionStore.setAuthUser(JSON.parse(localStorage.getItem("authUser"))),t.listener=null,t.registerAuthListener=function(e){return t.listener=e,!0},t}return Object(b.a)(r,[{key:"componentDidMount",value:function(){var e=this;this.unregisterHandler=this.props.firebase.onAuthUserListener((function(t){localStorage.setItem("authUser",JSON.stringify(t)),e.props.sessionStore.setAuthUser(t),e.listener&&e.listener(t)}),(function(){localStorage.removeItem("authUser"),e.props.sessionStore.setAuthUser(null),e.listener&&e.listener(null)}))}},{key:"componentWillUnmount",value:function(){this.unregisterHandler()}},{key:"render",value:function(){return i.a.createElement(e,Object.assign({},this.props,{registerAuthListener:this.registerAuthListener}))}}]),r}(i.a.Component);return Object(U.a)(P,Object(o.b)("sessionStore"))(t)}),ue=function(e){return function(t){var n=function(n){Object(N.a)(a,n);var r=Object(A.a)(a);function a(){return Object(d.a)(this,a),r.apply(this,arguments)}return Object(b.a)(a,[{key:"componentDidMount",value:function(){var t=this;this.listener=this.props.firebase.onAuthUserListener((function(n){e(n)||t.props.history.push("/signin")}),(function(){return t.props.history.push("/signin")}))}},{key:"componentWillUnmount",value:function(){this.listener()}},{key:"render",value:function(){return e(this.props.sessionStore.authUser)?i.a.createElement(t,this.props):null}}]),a}(i.a.Component);return Object(U.a)(_.i,P,Object(o.b)("sessionStore"),o.c)(n)}},pe=function(e){var t=function(t){Object(N.a)(r,t);var n=Object(A.a)(r);function r(e){var t;return Object(d.a)(this,r),(t=n.call(this,e)).onSendEmailVerification=function(){t.props.firebase.doSendEmailVerification().then((function(){return t.setState({isSent:!0})}))},t.state={isSent:!1},t}return Object(b.a)(r,[{key:"render",value:function(){return(t=this.props.sessionStore.authUser)&&!t.emailVerified&&t.providerData.map((function(e){return e.providerId})).includes("password")?i.a.createElement(x.n,{className:"login-page"},i.a.createElement(Q,{maxWidth:"150px",textStart:"Check",textEnd:"YourEmail"}),i.a.createElement(x.s,null,i.a.createElement(x.H,null,i.a.createElement(x.m,null,this.state.isSent?i.a.createElement(G.a,null,"Email_confirmation_sent"):i.a.createElement(G.a,null,"Email_verification_needed"))),i.a.createElement(x.H,null,i.a.createElement(x.m,null,i.a.createElement(x.e,{type:"button",onClick:this.onSendEmailVerification,disabled:this.state.isSent,expand:"block"},i.a.createElement(G.a,null,"Send confirmation E-Mail")),i.a.createElement(x.e,{type:"button",onClick:function(){return location.reload()},expand:"block",color:"secondary"},i.a.createElement(G.a,null,"Is confirmed. Reload")))))):i.a.createElement(e,this.props);var t}}]),r}(i.a.Component);return Object(U.a)(P,Object(o.b)("sessionStore"),o.c)(t)},de={email:"",password:"",error:null},me="\n  An account with an E-Mail address to\n  this social account already exists. Try to login from\n  this account instead and associate your social accounts on\n  your personal account page.\n",he=function(){var e=(this.props.location.state||{from:{pathname:"/"}}).from,t=this.state.redirectToReferrer,n=this.props.history;!0===t&&setTimeout((function(){return n.push(e&&e.pathname||V)}),500)},fe=function(e){Object(N.a)(n,e);var t=Object(A.a)(n);function n(e){var r;return Object(d.a)(this,n),(r=t.call(this,e)).onSubmit=function(e){var t=r.state,n=t.email,i=t.password;e.preventDefault(),r.props.firebase.doSignInWithEmailAndPassword(n,i).then((function(){r.setState(Object(g.a)({redirectToReferrer:!0},de))})).catch((function(e){r.setState({error:e})}))},r.onChange=function(e){r.setState(Object(E.a)({},e.target.name,e.target.value))},r.state=Object(g.a)({},de),r}return Object(b.a)(n,[{key:"render",value:function(){var e=this.state,t=e.email,n=e.password,r=e.error,a=""===n||""===t,s=this.props.t;return he.call(this),i.a.createElement("form",{onSubmit:this.onSubmit},i.a.createElement(x.H,null,i.a.createElement(x.m,null,i.a.createElement(x.w,{name:"email",value:t,onIonChange:this.onChange,clearInput:!0,type:"email",placeholder:s("Email"),className:"input","padding-horizontal":!0,"clear-input":"true",autocomplete:"username email"}))),i.a.createElement(x.H,null,i.a.createElement(x.m,null,i.a.createElement(x.w,{clearInput:!0,name:"password",value:n,onIonChange:this.onChange,type:"password",placeholder:s("Password"),className:"input",autocomplete:"current-password","padding-horizontal":!0}))),i.a.createElement(x.e,{disabled:a,type:"submit",expand:"block"},i.a.createElement(G.a,null,"Sign In")),r&&i.a.createElement("p",null,r.message))}}]),n}(r.Component),ge=function(e){Object(N.a)(n,e);var t=Object(A.a)(n);function n(e){var r;return Object(d.a)(this,n),(r=t.call(this,e)).onSubmit=function(e){r.props.firebase.doSignInWithGoogle({redirectUri:"/signin",state:r.props.location.state}).then((function(e){return r.props.firebase.user(e.user.uid).set({username:e.user.displayName,email:e.user.email,roles:{}},{merge:!0})})).then((function(){r.setState({redirectToReferrer:!0,error:null})})).catch((function(e){"auth/account-exists-with-different-credential"===e.code&&(e.message=me),r.setState({error:e})})),e.preventDefault()},r.state={error:null},r}return Object(b.a)(n,[{key:"render",value:function(){var e=this.state.error;return he.call(this),i.a.createElement("form",{onSubmit:this.onSubmit},i.a.createElement(x.H,null,i.a.createElement(x.m,null,i.a.createElement(x.e,{onClick:this.onSubmit,type:"submit",expand:"block",color:"secondary"},i.a.createElement(x.u,{icon:te.w}),i.a.createElement("span",{className:"social-button-text"},"Google")))),e&&i.a.createElement("p",null,e.message))}}]),n}(r.Component),be=function(e){Object(N.a)(n,e);var t=Object(A.a)(n);function n(e){var r;return Object(d.a)(this,n),(r=t.call(this,e)).onSubmit=function(e){r.props.firebase.doSignInWithFacebook().then((function(e){return r.props.firebase.user(e.user.uid).set({username:e.additionalUserInfo.profile.name,email:e.additionalUserInfo.profile.email,roles:{}},{merge:!0})})).then((function(){r.setState({redirectToReferrer:!0,error:null})})).catch((function(e){"auth/account-exists-with-different-credential"===e.code&&(e.message=me),r.setState({error:e})})),e.preventDefault()},r.state={error:null},r}return Object(b.a)(n,[{key:"render",value:function(){var e=this.state.error;return he.call(this),i.a.createElement("form",{onSubmit:this.onSubmit},i.a.createElement(x.H,null,i.a.createElement(x.m,null,i.a.createElement(x.e,{onClick:this.onSubmit,type:"submit",expand:"block",color:"secondary"},i.a.createElement(x.u,{icon:te.v}),i.a.createElement("span",{className:"social-button-text"},"Facebook")))),e&&i.a.createElement("p",null,e.message))}}]),n}(r.Component),Ee=function(e){Object(N.a)(n,e);var t=Object(A.a)(n);function n(e){var r;return Object(d.a)(this,n),(r=t.call(this,e)).onSubmit=function(e){r.props.firebase.doSignInWithTwitter().then((function(e){return r.props.firebase.user(e.user.uid).set({username:e.additionalUserInfo.profile.name,email:e.additionalUserInfo.profile.email,roles:{}},{merge:!0})})).then((function(){r.setState({redirectToReferrer:!0,error:null})})).catch((function(e){"auth/account-exists-with-different-credential"===e.code&&(e.message=me),r.setState({error:e})})),e.preventDefault()},r.state={error:null},r}return Object(b.a)(n,[{key:"render",value:function(){var e=this.state.error;return he.call(this),i.a.createElement("form",{onSubmit:this.onSubmit},i.a.createElement(x.H,null,i.a.createElement(x.m,null,i.a.createElement(x.e,{onClick:this.onSubmit,type:"submit",expand:"block",color:"secondary"},i.a.createElement(x.u,{icon:te.x}),i.a.createElement("span",{className:"social-button-text"},"Twitter")))),e&&i.a.createElement("p",null,e.message))}}]),n}(r.Component),Se=Object(U.a)(_.i,P,Object(J.a)())(fe),ye=Object(U.a)(_.i,P)(ge),ve=(Object(U.a)(_.i,P)(be),Object(U.a)(_.i,P)(Ee),pe((function(e){var t=!!(e.location.state&&e.location.state.from&&e.location.state.from.pathname.match("^/share/"));return i.a.createElement(i.a.Fragment,null,i.a.createElement(x.n,{className:"login-page"},i.a.createElement(Q,{maxWidth:t?"100px":"150px"}),t&&i.a.createElement(x.x,{color:"success",className:"permanent-message"},i.a.createElement(x.N,null,i.a.createElement("h5",null,i.a.createElement(G.a,null,"Sharing_link_received")))),i.a.createElement(x.s,null,i.a.createElement(Se,null),i.a.createElement(x.H,null,i.a.createElement(x.m,null,i.a.createElement(se,null),i.a.createElement("br",null),i.a.createElement($,{state:e.location.state}))),i.a.createElement("div",{className:"separator"},i.a.createElement(G.a,null,"or with")),i.a.createElement(ye,null))))}))),Le={passwordOne:"",passwordTwo:"",error:null},Oe=function(e){Object(N.a)(n,e);var t=Object(A.a)(n);function n(e){var r;return Object(d.a)(this,n),(r=t.call(this,e)).onSubmit=function(e){var t=r.state.passwordOne;r.props.firebase.doPasswordUpdate(t).then((function(){r.setState(Object(g.a)({},Le))})).catch((function(e){r.setState({error:e})})),e.preventDefault()},r.onChange=function(e){r.setState(Object(E.a)({},e.target.name,e.target.value))},r.state=Object(g.a)({},Le),r}return Object(b.a)(n,[{key:"render",value:function(){var e=this.state,t=e.passwordOne,n=e.passwordTwo,r=e.error,a=t!==n||""===t;return i.a.createElement("form",{onSubmit:this.onSubmit},i.a.createElement(x.H,null,i.a.createElement(x.m,null,i.a.createElement(x.w,{name:"passwordOne",value:t,onIonChange:this.onChange,clearInput:!0,type:"password",placeholder:"Type your password",class:"input","padding-horizontal":!0,"clear-input":"true"}),i.a.createElement(x.w,{name:"passwordTwo",value:n,onIonChange:this.onChange,clearInput:!0,type:"password",placeholder:"Confirm new password",class:"input","padding-horizontal":!0,"clear-input":"true"}))),i.a.createElement(x.e,{type:"submit",disabled:a,expand:"block"},"Reset My Password"),r&&i.a.createElement("p",null,r.message))}}]),n}(r.Component),Ie=function(){return i.a.createElement(x.e,{expand:"block",color:"secondary",href:"/pw-change"},i.a.createElement(G.a,null,"Change Password"),i.a.createElement(x.u,{slot:"end",icon:te.A}))},je=P(Oe),we=function(){return i.a.createElement(i.a.Fragment,null,i.a.createElement(x.t,null,i.a.createElement(x.R,null,i.a.createElement(x.f,{slot:"start"},i.a.createElement(re,{defaultHref:"/account"})))),i.a.createElement(x.n,{className:"login-page"},i.a.createElement(Q,{maxWidth:"100px",textStart:"Change",textEnd:"MyPassword!"}),i.a.createElement(x.s,null,i.a.createElement(je,null))))},Ce=n(89),ke=n.n(Ce),Ne=function(e){var t=e.user,n=e.size,r=void 0===n?200:n,a=t?t.photoURL:null,s=ke()(t.email),o=encodeURIComponent(encodeURIComponent(t.username)),c=a||"https://www.gravatar.com/avatar/".concat(s,"?s=").concat(r,"&d=https%3A%2F%2Fui-avatars.com%2Fapi%2F/").concat(o,"/").concat(r,"%3Frounded%3Dtrue%26bold%3Dtrue");return i.a.createElement("img",{src:c,alt:"User Profile",style:{borderRadius:"50%"}})},Ae=Object(U.a)(Object(o.b)("sessionStore"),o.c)((function(e){var t=e.sessionStore.authUser;return i.a.createElement(x.g,{style:{padding:"30px"}},i.a.createElement(x.h,{class:"ion-text-center"},i.a.createElement(Ne,{user:t,size:150}),i.a.createElement(x.i,null,t.username),i.a.createElement(x.j,null,t.email)))})),xe=P((function(e){var t=e.firebase;return i.a.createElement(x.e,{expand:"block",onClick:t.doSignOut},i.a.createElement(G.a,null,"Sign Out"),i.a.createElement(x.u,{slot:"end",icon:te.u}))})),De=(n(127),Object(U.a)(Object(o.b)("sessionStore"),o.c,pe,ue((function(e){return!!e})))((function(){return i.a.createElement(x.D,null,i.a.createElement(x.t,null,i.a.createElement(x.R,null,i.a.createElement(x.O,null,i.a.createElement(G.a,null,"Account")))),i.a.createElement(x.n,null,i.a.createElement(x.t,{collapse:"condense"},i.a.createElement(x.R,null,i.a.createElement(x.O,{size:"large"},i.a.createElement(G.a,null,"Account")))),i.a.createElement(Ae,null),i.a.createElement(x.r,null,i.a.createElement(x.R,null,i.a.createElement(Ie,null),i.a.createElement(xe,null)))))}))),_e=function(e){Object(N.a)(n,e);var t=Object(A.a)(n);function n(e){var r;return Object(d.a)(this,n),(r=t.call(this,e)).state={loading:!1},r}return Object(b.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.setState({loading:!0}),this.unsubscribe=this.props.firebase.users().onSnapshot((function(t){var n=[];t.forEach((function(e){return n.push(Object(g.a)({},e.data(),{uid:e.id}))})),e.props.userStore.setUsers(n),e.setState({loading:!1})}))}},{key:"componentWillUnmount",value:function(){this.unsubscribe()}},{key:"render",value:function(){var e=this.props.userStore.userList,t=this.state.loading;return i.a.createElement("div",null,i.a.createElement("h2",null,"Users"),t&&i.a.createElement("div",null,"Loading ..."),i.a.createElement("ul",null,e.map((function(e){return i.a.createElement("li",{key:e.uid},i.a.createElement("span",null,i.a.createElement("strong",null,"ID:")," ",e.uid),i.a.createElement("span",null,i.a.createElement("strong",null,"E-Mail:")," ",e.email),i.a.createElement("span",null,i.a.createElement("strong",null,"Username:")," ",e.username),i.a.createElement("span",null,i.a.createElement(F.c,{to:"".concat("/admin","/").concat(e.uid)},"Details")))}))))}}]),n}(r.Component),Ue=Object(U.a)(P,Object(o.b)("userStore"),o.c)(_e),Fe=function(e){Object(N.a)(n,e);var t=Object(A.a)(n);function n(e){var r;return Object(d.a)(this,n),(r=t.call(this,e)).onSendPasswordResetEmail=function(){r.props.firebase.doPasswordReset(r.props.userStore.users[r.props.match.params.id].email)},r.state={loading:!1},r}return Object(b.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.props.userStore.users&&this.props.userStore.users[this.props.match.params.id]||this.setState({loading:!0}),this.unsubscribe=this.props.firebase.user(this.props.match.params.id).onSnapshot((function(t){e.props.userStore.setUser(e.props.match.params.id,t.data()),e.setState({loading:!1})}))}},{key:"componentWillUnmount",value:function(){this.unsubscribe&&this.unsubscribe()}},{key:"render",value:function(){var e=(this.props.userStore.users||{})[this.props.match.params.id],t=this.state.loading;return i.a.createElement("div",null,i.a.createElement("h2",null,"User (",this.props.match.params.id,")"),t&&i.a.createElement("div",null,"Loading ..."),e&&i.a.createElement("div",null,i.a.createElement("span",null,i.a.createElement("strong",null,"ID:")," ",e.uid),i.a.createElement("span",null,i.a.createElement("strong",null,"E-Mail:")," ",e.email),i.a.createElement("span",null,i.a.createElement("strong",null,"Username:")," ",e.username),i.a.createElement("span",null,i.a.createElement("button",{type:"button",onClick:this.onSendPasswordResetEmail},"Send Password Reset"))))}}]),n}(r.Component),ze=Object(U.a)(P,Object(o.b)("userStore"),o.c)(Fe),Pe=Object(U.a)(pe,ue((function(e){return e&&!!e.roles.ADMIN})))((function(){return i.a.createElement("div",null,i.a.createElement("h1",null,"Admin"),i.a.createElement("p",null,"The Admin Page is accessible by every signed in admin user."),i.a.createElement(_.e,null,i.a.createElement(_.c,{exact:!0,path:"/admin/:id",component:ze}),i.a.createElement(_.c,{exact:!0,path:"/admin",component:Ue})))})),Me=n(54),Re=function(e){Object(N.a)(n,e);var t=Object(A.a)(n);function n(e){var r;return Object(d.a)(this,n),(r=t.call(this,e)).onListenForShoppingLists=function(){r.unsubscribeLists=r.props.firebase.myShoppingLists().orderBy("createdAt","desc").onSnapshot((function(e){var t=null;if(r.props.shoppingStore.setInitializationDone(!0),e.size){var n=[];e.forEach((function(e){var r=e.data();n.push(Object(g.a)({},r,{uid:e.id})),r.isCurrent&&(t=e.id)})),r.props.shoppingStore.setShoppingLists(n),r.setState(Object.assign(r.state,{listsLoading:!1}))}else r.props.shoppingStore.setShoppingLists([]),r.setState({listsLoading:!1,itemsLoading:!1});r.unsubscribeItems&&r.unsubscribeItems(),r.onListenForCurrentShoppingListItems(t),r.unsubscribeDependentNeedsLists&&r.unsubscribeDependentNeedsLists(),r.unsubscribeAllDependentNeedsListItems(),r.onListenForDependentNeedsLists(t)}))},r.onListenForCurrentShoppingListItems=function(e){r.unsubscribeItems=r.props.firebase.listItems(e).onSnapshot((function(e){if(e.size){var t=[];e.forEach((function(e){return t.push(Object(g.a)({},e.data(),{uid:e.id,parentId:e.ref.parent.parent.id}))})),r.props.shoppingStore.setCurrentShoppingListItems(t),r.setState({itemsLoading:!1})}else r.props.shoppingStore.setCurrentShoppingListItems([]),r.setState({itemsLoading:!1})}))},r.onListenForDependentNeedsLists=function(e){r.unsubscribeDependentNeedsLists=r.props.firebase.dependentNeedsListOfShoppingList(e).onSnapshot((function(e){if(r.unsubscribeAllDependentNeedsListItems(),e.size){var t=[];r.unsubscribeDependentNeedsListsItems=[],e.forEach((function(e){var n=e.data();t.push(Object(g.a)({},n,{uid:e.id})),r.onListenForDependentNeedsListsItems(e.id);var i=n.userId;r.props.userStore.users[i]||r.props.firebase.user(i).get().then((function(e){var t=e.data();r.props.userStore.setUser(e.id,t)}))})),r.props.shoppingStore.setCurrentDependentNeedsLists(t)}else r.props.shoppingStore.setCurrentDependentNeedsLists([])}))},r.onListenForDependentNeedsListsItems=function(e){r.unsubscribeDependentNeedsListsItems.push(r.props.firebase.listItems(e).onSnapshot((function(t){var n=[];t.forEach((function(e){return n.push(Object(g.a)({},e.data(),{uid:e.id,parentId:e.ref.parent.parent.id}))})),r.props.shoppingStore.setDependentNeedsListItems(e,n)})))},r.onChangeText=function(e){r.setState({editingListName:e.target.value})},r.handleCreateShoppingList=function(e){e.preventDefault(),r.props.firebase.createShoppingList({name:r.state.editingListName}),r.setState({editingListName:""})},r.onCreateShoppingList=function(e){r.props.firebase.createShoppingList({name:e})},r.onEditShoppingList=function(e){e.uid;var t=Object(Me.a)(e,["uid"]);r.props.firebase.editList(e.uid,t)},r.onRemoveShoppingList=function(e){r.props.firebase.deleteList(e)},r.onSetCurrentShoppingList=function(e){r.props.firebase.setCurrentShoppingList(e)},r.onReorderItems=function(e,t,n){r.props.firebase.setItemsOrder(e,t,n)},r.onOpenShopping=function(e){r.props.firebase.openShopping(e)},r.onGoShopping=function(e){r.props.firebase.goShopping(e)},r.onFinishShopping=function(e){r.props.firebase.finishShopping(e)},r.onArchiveShoppingList=function(){var e=Object(q.a)(T.a.mark((function e(t){var n,i=arguments;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!(i.length>1&&void 0!==i[1])||i[1])){e.next=5;break}return e.next=4,r.props.firebase.createListFromTemplate(t,!0);case 4:n=e.sent;case 5:return r.props.firebase.archiveShoppingList(t),e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.onCreateItemForCurrentShoppingList=function(e){var t=r.props.shoppingStore.currentShoppingList;return t?r.props.firebase.createItem(t.uid,e):(console.error("Cannot create item for non-existing shoppingList"),new Promise((function(){return null})))},r.onEditShoppingItem=function(e){var t=r.props.shoppingStore.currentShoppingList;t?r.props.firebase.editItem(t.uid,e):console.error("Cannot edit item in non-existing shoppingList")},r.onRemoveShoppingItem=function(e){var t=r.props.shoppingStore.currentShoppingList;t?r.props.firebase.deleteItem(t.uid,e):console.error("Cannot remove item from non-existing shoppingList")},r.onShopShoppingItem=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];r.props.firebase.shopItem(e,t,n)},r.ensureExistingCurrentShoppingList=Object(q.a)(T.a.mark((function e(){return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.props.firebase.myCurrentShoppingList().get();case 2:if(e.sent.size){e.next=5;break}return e.abrupt("return",r.props.firebase.createShoppingList({name:""}));case 5:case"end":return e.stop()}}),e)}))),r.state={listsLoading:!1,itemsLoading:!1},r}return Object(b.a)(n,[{key:"_tryInitialization",value:function(){this.props.sessionStore.dbAuthenticated&&!this.unsubscribeLists&&(this.ensureExistingCurrentShoppingList(),this.onListenForShoppingLists(),this.onListenForCurrentShoppingListItems())}},{key:"componentDidMount",value:function(){this.props.shoppingStore.shoppingListsArray.length||this.setState({listsLoading:!0,itemsLoading:!0}),this._tryInitialization()}},{key:"componentDidUpdate",value:function(){this._tryInitialization()}},{key:"componentWillUnmount",value:function(){this.unregisterAllListeners()}},{key:"unregisterAllListeners",value:function(){this.unsubscribeLists&&this.unsubscribeLists(),this.unsubscribeItems&&this.unsubscribeItems(),this.unsubscribeDependentNeedsLists&&this.unsubscribeDependentNeedsLists(),this.unsubscribeAllDependentNeedsListItems()}},{key:"unsubscribeAllDependentNeedsListItems",value:function(){this.unsubscribeDependentNeedsListsItems&&this.unsubscribeDependentNeedsListsItems.length&&this.unsubscribeDependentNeedsListsItems.forEach((function(e){return e()}))}}]),n}(r.Component),Te=n(19),qe="shopping",We="newShopping",He="need",Be="inShopping",Ke="bringAlong",Ve=function(e){Object(N.a)(n,e);var t=Object(A.a)(n);function n(e){var r;return Object(d.a)(this,n),(r=t.call(this,e)).onKeyPress=function(e){13===e.which&&r.concludeEditing()},r.state=Object(g.a)({},e.item,{showToast:!1,message:""}),r.nameInput=i.a.createRef(),r.quantityInput=i.a.createRef(),r}return Object(b.a)(n,[{key:"concludeEditing",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.props,n=t.item,r=t.t;if(e){var i=this.state,a=i.name,s=i.quantity,o=i.unit,c=void 0===o?"":o;a&&s?this.props.onEditingConcluded(Object.assign(n,{name:a,quantity:s,unit:c})):this.setState({showToast:!0,message:r("Name_and_quantity_mandatory")}),this.quantityInput.current.setFocus()}else this.props.onEditingConcluded(n)}},{key:"componentDidMount",value:function(){var e=this;setTimeout((function(){e.quantityInput.current&&e.quantityInput.current.setFocus()}),500)}},{key:"onChange",value:function(e){this.setState(Object(E.a)({},e.target.name,e.target.value))}},{key:"onBlur",value:function(e){e.target.parentElement!==e.srcElement.parentElement&&this.concludeEditing()}},{key:"setUnit",value:function(e){this.setState({unit:e})}},{key:"render",value:function(){var e=this,t=this.state,n=t.name,r=t.quantity,a=t.unit,s=this.props.t,o=this.props.mode===qe?i.a.createElement(x.I,{value:a,required:"true",slot:"end",onIonChange:function(t){return e.setUnit(t.detail.value)}},i.a.createElement(x.J,null,"pc"),i.a.createElement(x.J,null,"g"),i.a.createElement(x.J,null,"kg"),i.a.createElement(x.J,null,"l"),i.a.createElement(x.J,null,"ml")):i.a.createElement(x.y,{marginLeft:"2px",slot:"end"},a);return i.a.createElement(i.a.Fragment,null,i.a.createElement(x.x,{style:{width:"100%"}},i.a.createElement(x.w,{placeholder:s("Item name"),name:"name",value:n,autocapitalize:!0,autocorrect:"on",debounce:100,style:{marginRight:"0px",minWidth:"135px"},size:16,slot:"",onKeyUp:this.onKeyPress,onIonInput:function(t){return e.onKeyPress(t)},onIonChange:function(t){return e.onChange(t)},onIonBlur:function(t){return e.onBlur(t)},ref:this.nameInput}),i.a.createElement(x.w,{placeholder:s("Quantity"),name:"quantity",type:"number",min:"0",pattern:"\\d+,?\\d*",value:r,onKeyUp:this.onKeyPress,onIonChange:function(t){return e.onChange(t)},onIonBlur:function(t){return e.onBlur(t)},required:"false",slot:"end",style:{marginRight:"0px",maxWidth:"42px",textAlign:"right"},ref:this.quantityInput}),o,i.a.createElement(x.e,{color:"danger",slot:"end",onClick:function(){return e.concludeEditing(!1)}},i.a.createElement(x.u,{icon:te.l})),i.a.createElement(x.e,{color:"success",slot:"end",onClick:function(){return e.concludeEditing()},style:{marginLeft:"10px"}},i.a.createElement(x.u,{icon:te.g}))),i.a.createElement(x.P,{isOpen:this.state.showToast,onDidDismiss:function(){return e.setState((function(){return{showToast:!1}}))},message:this.state.message,duration:3e3}))}}]),n}(r.Component),Ge=Object(J.a)()(Ve),Je=function(e){var t=e.user,n=e.size,r=void 0===n?200:n,a=e.slot,s=void 0===a?"":a;return i.a.createElement(x.c,{style:{width:r,height:r},slot:s},i.a.createElement(Ne,{size:r,user:t}))},Qe=function(e){Object(N.a)(n,e);var t=Object(A.a)(n);function n(e){var r;return Object(d.a)(this,n),(r=t.call(this,e)).state={inEdit:!e.item.quantity},r}return Object(b.a)(n,[{key:"setEditMode",value:function(e){this.props.readOnly||this.setState({inEdit:e})}},{key:"onItemClick",value:function(){var e=this.props.item,t=e.uid,n=e.parentId,r=e.shopped;switch(this.props.mode){case Be:case Ke:this.props.onShopItem(n,t,!r);break;case"potential":break;default:this.setEditMode(!0)}}},{key:"render",value:function(){var e=this,t=this.props,r=t.item,a=t.bringAlongItems,s=t.mode,o=t.listEditMode,c=t.ownList,l=t.owner,u=t.onCreateNeed,p=t.onDeleteItem,d=t.onEditingConcluded,h=t.onShopItem,f=t.readOnly,g=!c&&!f&&"potential"===s&&i.a.createElement(x.e,{fill:"add",size:"large",slot:"end",color:"primary","data-test":"btn-create-need",onClick:function(){return u(r)}},i.a.createElement(x.u,{icon:te.a})),b=([He,Be,Ke].includes(s)||[qe,We].includes(s)&&(r.quantity>1||r.unit))&&i.a.createElement(x.l,{onClick:function(){return e.setEditMode(!0)},color:r.shopped?"success":"primary"},i.a.createElement(x.y,{color:r.shopped?"success":"dark","data-test":"label-quantity"},s===Ke&&"+",r.quantity," ",r.unit)),E=c&&!f&&(s===qe&&o||s===He)&&i.a.createElement(x.e,{className:"button-end",fill:"clear",size:"large",slot:"end",color:"danger",onClick:function(){return p(r.uid)},"data-test":"btn-delete-item"},i.a.createElement(x.u,{icon:te.J})),S=c&&!f&&[qe].includes(s)&&!(s===qe&&o)&&i.a.createElement(x.e,{className:"button-end",fill:"clear",size:"large",slot:"end",onClick:function(){return e.setEditMode(!0)},"data-test":"btn-edit-item"},i.a.createElement(x.u,{icon:te.n,slot:"end"})),y=l&&i.a.createElement(x.e,{fill:"clear",size:"large",slot:"start","data-test":"btn-owner"},i.a.createElement(Je,{size:"30px",user:l})),v=function(){if(s===qe&&a&&a.length){var e=a.reduce((function(e,t){return e+Number(t.quantity)}),0);if(e>0)return i.a.createElement("span",{style:{display:"flex"}},i.a.createElement(x.l,{color:"secondary"},i.a.createElement(x.u,{icon:te.I}),i.a.createElement(x.y,{color:"secondary","data-test":"label-bring-along-quantity"},"+",e," ",r.unit)))}return null},L=this.state.inEdit?i.a.createElement(Ge,{item:Object(m.o)(r),onEditingConcluded:function(t){e.setEditMode(!1),d(t)},mode:s}):i.a.createElement(i.a.Fragment,null,[Be,Ke].includes(s)&&i.a.createElement(x.k,{slot:"start",style:s===Ke?{marginLeft:"40px"}:null,value:r.name,checked:r.shopped,onClick:function(){return e.onItemClick()},color:"primary","data-test":"check-shopped"}),i.a.createElement(x.y,{style:{cursor:"pointer",textDecoration:r.shopped?"line-through":"none",color:r.shopped||s===Ke?"grey":"black"},onClick:function(){return e.onItemClick()},"data-test":"label-item-name"},r.name),i.a.createElement(v,null),y,b,g,S,E),O=s===Be&&a&&i.a.createElement(x.A,{"data-test":"dependent-items"},a.map((function(t){var r=e.props.userStore.users[t.ownerId];return i.a.createElement(n,{key:t.uid,item:t,owner:r,ownList:!1,onShopItem:function(){return h(t.parentId,t.uid,!t.shopped)},mode:Ke})})));return i.a.createElement(i.a.Fragment,null,i.a.createElement(x.x,{id:r.uid,"data-test":"item"},i.a.createElement(x.E,{slot:"start"}),L),O)}}]),n}(r.Component),Ze=Object(U.a)(Object(o.b)("userStore"),o.c)(Qe),Ye=function(e){var t=e.name,n=e.onChange,r=Object(ne.a)().t;return i.a.createElement(i.a.Fragment,null,i.a.createElement(x.x,{key:"EditListNameWrapper",style:{width:"100%"},"data-test":"edit-list-name"},i.a.createElement(x.y,{slot:"start"},"".concat(r("Name of shopping list"),":")),i.a.createElement(x.w,{placeholder:r("Shopping list"),name:"name",value:t,type:"text",autocapitalize:!0,autocorrect:"on",debounce:100,"data-test":"input-list-name",onIonChange:function(e){return n(e)},onIonBlur:function(e){return n(e)}})))},$e=function(e){Object(N.a)(n,e);var t=Object(A.a)(n);function n(e){var r;return Object(d.a)(this,n),(r=t.call(this,e)).onChangeEditName=function(e){r.setState({editName:e.target.value})},r.onSaveEditName=function(){r.props.onEditList(Object.assign(r.props.list,{name:r.state.editName}))},r.state={editName:r.props.list.name},r.props.addSaveEditHandler&&r.props.addSaveEditHandler(r.saveEdit.bind(Object(Te.a)(r))),r}return Object(b.a)(n,[{key:"doReorder",value:function(e){e.detail.complete();var t=e.srcElement.children,n={};e.detail.complete();var r=0;for(var i in t)r++,t.hasOwnProperty(i)&&t[i].id&&(n[t[i].id]=r);this.setState({order:n})}},{key:"saveEdit",value:function(){var e=this;if(this.onSaveEditName(),this.state.order){this.props.onReorderItems(this.props.list.uid,this.props.items,this.state.order);var t=this.props.shoppingStore,n=t.currentDependentNeedsListsArray,r=t.currentDependentNeedsListsItemsArray;n.forEach((function(t){e.props.onReorderItems(t.uid,r.filter((function(e){return e.parentId===t.uid})),e.state.order)}))}}},{key:"render",value:function(){var e=this,t=this.props,n=t.items,r=t.list,a=t.onEditList,s=t.onEditItem,o=t.onDeleteItem,c=t.onShopItem,l=t.editMode,u=t.userStore,p={},d=[];(this.props.bringAlongItems||[]).forEach((function(e){if(e.quantity<=0)return!1;var t=n.find((function(t){return t.uid===e.originShoppingItemId}))||n.find((function(t){return t.name===e.name}));if(t)p[t.uid]&&p[t.uid].length?p[t.uid].push(e):p[t.uid]=[e];else{var r=u.users[e.ownerId];d.push(Object(g.a)({},e,{owner:r,ownedByOtherUser:!0}))}}));var m=(n||[]).concat(d||[]);return i.a.createElement(i.a.Fragment,null,l&&r&&i.a.createElement(i.a.Fragment,null,i.a.createElement(Ye,{name:this.state.editName,onChange:function(t){return e.onChangeEditName(t)}}),i.a.createElement(x.x,null,i.a.createElement(x.y,null,i.a.createElement(G.a,null,"Allow friends to add own needs")),i.a.createElement(x.Q,{name:"allowCreateOwnNeeds",checked:r.allowCreateOwnNeeds,onIonChange:function(){a(Object.assign(r,{allowCreateOwnNeeds:!r.allowCreateOwnNeeds}))}}))),m.length>0&&i.a.createElement(x.A,null,!l&&m.sort((function(e,t){return L(e,t)})).map((function(t,n){var r=p[t.uid];return i.a.createElement(Ze,{key:t.id||n,item:t,owner:t.owner,bringAlongItems:r,ownList:!t.ownedByOtherUser,onEditingConcluded:s,onDeleteItem:o,onShopItem:c,mode:e.props.mode,readOnly:"open"!==e.props.list.lifecycleStatus||t.ownedByOtherUser})})),l&&i.a.createElement(i.a.Fragment,null,i.a.createElement(x.B,null,i.a.createElement(x.y,null,i.a.createElement("h1",null,i.a.createElement(G.a,null,"Items")))),i.a.createElement(x.F,{disabled:!1,onIonItemReorder:this.doReorder.bind(this)},n.concat(d||[]).sort((function(e,t){return L(e,t)})).map((function(t,n){return i.a.createElement(Ze,{key:t.id||n,item:t,ownList:!0,onEditingConcluded:s,onDeleteItem:o,onShopItem:c,mode:e.props.mode,readOnly:"open"!==e.props.list.lifecycleStatus,listEditMode:l})}))))))}}]),n}(r.Component),Xe=Object(U.a)(Object(o.b)("shoppingStore","userStore"),o.c)($e),et=function(e){var t=e.loading,n=Object(ne.a)().t;return i.a.createElement(x.C,{isOpen:t,message:n("Loading_message")})},tt=(n(128),["pc","g","kg","l","ml","oz","St\xfcck","Packungen"]),nt=function(e){Object(N.a)(n,e);var t=Object(A.a)(n);function n(e){var r;return Object(d.a)(this,n),(r=t.call(this,e)).onKeyPress=function(e){13===e.which&&r.concludeEditing()},r.state={showToast:!1,message:""},r.nameInput=i.a.createRef(),r.quantityInput=i.a.createRef(),r}return Object(b.a)(n,[{key:"_setFocus",value:function(){var e=this;this.state.name?setTimeout((function(){return e.quantityInput.current&&e.quantityInput.current.setFocus()}),100):setTimeout((function(){return e.nameInput.current&&e.nameInput.current.setFocus()}),100)}},{key:"concludeEditing",value:function(){var e=this.props.t,t=this.props.item,n=t.name,r=t.quantity,i=t.unit,a=void 0===i?"":i;n?r?this.props.onEditingConcluded({name:n,quantity:r||1,unit:a}):this.props.onEditingConcluded(function(e){try{var t=new RegExp("^((\\d)+)\\s?(".concat(tt.join("|"),")?\\s((.)+)$"),"i"),n=e.match(t);if(n)return{name:n[4],quantity:parseFloat(n[1]),unit:n[3]||""};var r=new RegExp("^((.)+)\\s((\\d)+)\\s?(".concat(tt.join("|"),")?$"),"i"),i=e.match(r);if(i)return{name:i[1],quantity:parseFloat(i[3]),unit:i[5]||""}}catch(a){return{name:e,quantity:1}}return{name:e,quantity:1}}(n)):this.setState({showToast:!0,message:e("Name_mandatory")}),this._setFocus()}},{key:"onChange",value:function(e){this.props.onChange(e)}},{key:"onBlur",value:function(e){e.target.parentElement!==e.srcElement.parentElement&&this.concludeEditing()}},{key:"setUnit",value:function(e){this.props.onChange({target:{name:"unit",value:e}})}},{key:"componentDidMount",value:function(){this._setFocus()}},{key:"render",value:function(){var e=this,t=this.props.item,n=t.name,r=t.quantity,a=t.unit,s=t.originShoppingItemUid,o=this.props,c=o.t,l=o.isFirstItem,u=o.highlight,p=this.props.mode===He&&a?i.a.createElement(x.y,{slot:"end",className:"hide-sm-down"},a):i.a.createElement(x.I,{value:a,required:"true",slot:"end",style:{marginRight:"0px"},onIonChange:function(t){return e.setUnit(t.detail.value)},className:"hide-sm-down","data-test":"select-unit"},tt.map((function(e){return i.a.createElement(x.J,{key:e},e)})));return i.a.createElement(i.a.Fragment,null,i.a.createElement(x.x,{key:"createItemWrapper",lines:"none",style:{width:"100%"},className:"create-item ".concat((l||u)&&"highlight"),"data-test":"create-item"},i.a.createElement(x.w,{placeholder:c("Item name"),name:"name",value:n,type:"text",readonly:!!s,required:"true",autocapitalize:!0,autocorrect:"on",debounce:100,style:{marginRight:"0px",minWidth:"135px"},size:16,ref:this.nameInput,slot:"start","data-test":"input-name",onKeyUp:this.onKeyPress,onIonInput:function(t){return e.onKeyPress(t)},onIonChange:function(t){return e.onChange(t)},onIonBlur:function(t){return e.onBlur(t)}}),i.a.createElement(x.w,{placeholder:c("Quantity"),name:"quantity",type:"number",min:"0",pattern:"\\d+,?\\d*",value:r,required:"false",slot:"end",style:{marginRight:"0px",minWidth:"63px"},className:"hide-sm-down",ref:this.quantityInput,"data-test":"input-quantity",onKeyUp:this.onKeyPress,onIonChange:function(t){return e.onChange(t)},onIonBlur:function(t){return e.onBlur(t)}}),p,i.a.createElement(x.e,{slot:"end","data-test":"btn-create-item",onClick:function(){return e.concludeEditing()},style:{marginLeft:"10px"}},i.a.createElement(x.u,{icon:te.b}))),i.a.createElement(x.P,{isOpen:this.state.showToast,onDidDismiss:function(){return e.setState((function(){return{showToast:!1}}))},message:this.state.message,duration:3e3}))}}]),n}(r.Component),rt=Object(J.a)()(nt),it=function(e){Object(N.a)(n,e);var t=Object(A.a)(n);function n(e){var r;return Object(d.a)(this,n),(r=t.call(this,e)).state={itemInCreation:{}},r.statusTransitionTriggered=!1,r}return Object(b.a)(n,[{key:"componentDidUpdate",value:function(){!this.statusTransitionTriggered&&this.props.shoppingStore.currentShoppingList&&(this.props.model.onOpenShopping(this.props.shoppingStore.currentShoppingList),this.statusTransitionTriggered=!0)}},{key:"onCreatingItemChange",value:function(e){this.setState({itemInCreation:Object.assign(this.state.itemInCreation,Object(E.a)({},e.target.name,e.target.value))})}},{key:"onListNameChange",value:function(e){this.setState({editingListName:e.target.value})}},{key:"onCreateComplete",value:function(e){e.name&&e.quantity&&(this.props.model.onCreateItemForCurrentShoppingList(e),this.setState({itemInCreation:{}}))}},{key:"render",value:function(){var e=this.props,t=e.shoppingStore,n=e.sessionStore,r=e.location,a=e.editMode,s=t.currentShoppingList,o=t.currentShoppingListItemsArray,c=t.currentDependentNeedsListsArray,l=t.currentDependentNeedsListsItemsArray,u=t.initializationDone,p="/go-shopping"===r.pathname?Be:qe;return u?s&&i.a.createElement(i.a.Fragment,null,!a&&"open"===s.lifecycleStatus&&i.a.createElement(x.A,null,i.a.createElement(x.x,null,i.a.createElement(rt,{item:this.state.itemInCreation,mode:qe,isFirstItem:!o.length,onChange:this.onCreatingItemChange.bind(this),onEditingConcluded:this.onCreateComplete.bind(this)}))),i.a.createElement(Xe,{authUser:n.authUser,list:s,items:o,mode:p,dependentNeedLists:c,bringAlongItems:l,onEditList:this.props.model.onEditShoppingList,onEditItem:this.props.model.onEditShoppingItem,onShopItem:this.props.model.onShopShoppingItem,onDeleteItem:this.props.model.onRemoveShoppingItem,onReorderItems:this.props.model.onReorderItems,editMode:this.props.editMode,addSaveEditHandler:this.props.addSaveEditHandler})):i.a.createElement(et,{loading:u})}}]),n}(r.Component),at=Object(U.a)(_.i,Object(o.b)("shoppingStore","sessionStore"),o.c)(it),st=n(90),ot=function(e){Object(N.a)(n,e);var t=Object(A.a)(n);function n(e){var r;return Object(d.a)(this,n),(r=t.call(this,e)).generateShareLink=function(){var e=r.props.shoppingStore.currentShoppingList.uid;return"".concat(window.location.origin,"/share/").concat(e)},r._hasUnmounted=!1,r.state={message:"",showToast:!1},r}return Object(b.a)(n,[{key:"componentDidMount",value:function(){var e=Object(q.a)(T.a.mark((function e(){return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._hasUnmounted){e.next=2;break}return e.abrupt("return");case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this._hasUnmounted=!0}},{key:"render",value:function(){var e=this,t=this.props.t,n=t("Sharing_message"),r="Sharing_message"!==n?n+" ":"";return i.a.createElement(i.a.Fragment,null,i.a.createElement(st.CopyToClipboard,{text:r+this.generateShareLink()},i.a.createElement(x.p,{title:t("Share"),color:"primary",onClick:function(){e.setState({showToast:!0,message:t("Sharing_link_copied")})}},i.a.createElement(x.u,{icon:te.I}))),i.a.createElement(x.P,{isOpen:this.state.showToast,onDidDismiss:function(){return e.setState((function(){return{showToast:!1}}))},message:this.state.message,duration:5e3}))}}]),n}(r.Component),ct=Object(U.a)(Object(J.a)(),Object(o.b)("shoppingStore"),_.i)(ot),lt=(n(77),Object(_.i)((function(){var e=Object(ne.a)().t;return i.a.createElement(x.p,{color:"primary",href:"/go-shopping",title:e("Go Shopping")},i.a.createElement(x.u,{icon:te.e}))}))),ut=(n(132),function(e){var t=e.onClick,n=e.title;return i.a.createElement(x.p,{color:"primary",title:n,onClick:t,"data-test":"fab-btn-create-list"},i.a.createElement(x.u,{icon:te.b}))}),pt=Object(U.a)(Object(o.b)("shoppingStore"))((function(e){var t=e.model,n=e.shoppingStore,r=e.hasItems,a=Object(ne.a)().t,s=n.initializationDone,o=n.currentShoppingList,c=function(){return i.a.createElement(ut,{title:a("Create Shopping List"),onClick:function(){return t.onCreateShoppingList("".concat(a("Shopping list")))}})};return s?o&&"archived"!==o.lifecycleStatus&&!r?null:i.a.createElement(x.o,{vertical:"bottom",horizontal:"end",className:"shopping-actions"},o&&"archived"!==o.lifecycleStatus?i.a.createElement(i.a.Fragment,null,i.a.createElement(x.p,null,i.a.createElement(x.u,{icon:te.p})),i.a.createElement(x.q,{side:"top"},i.a.createElement(ct,null),i.a.createElement(lt,{model:t}),i.a.createElement(c,null))):i.a.createElement(c,null)):null})),dt=function(e){var t=e.href,n=e.label;return i.a.createElement(x.e,{fill:"clear","data-test":"btn-all-lists",href:t},i.a.createElement("span",{className:"hide-sm-down"},i.a.createElement(G.a,null,n)),i.a.createElement(x.u,{slot:"start",icon:te.q}))},mt=function(e){var t=e.list,n=Object(ne.a)().t;return t?t.name||n("Shopping list"):""},ht=function(e){var t=e.list,n=e.slot,r=void 0===n?"":n,a=e.defaultIcon,s=void 0===a?null:a;if(!t)return null;switch(t.lifecycleStatus){case"shopping":return i.a.createElement(x.u,{color:"primary",slot:r,icon:te.e});case"finished":return i.a.createElement(x.u,{color:"primary",slot:r,icon:te.C});case"archived":return i.a.createElement(x.u,{color:"danger",slot:r,icon:te.K});default:return s&&i.a.createElement(x.u,{color:"primary",slot:r,icon:s,"data-test":"icon-lifecycle"})}},ft=function(e){var t=e.shoppingList,n=e.slot,r=void 0===n?"":n,a=e.size,s=void 0===a?"":a;return t&&i.a.createElement(x.u,{size:s,slot:r,icon:t.allowCreateOwnNeeds?te.t:te.s})},gt=function(e){Object(N.a)(n,e);var t=Object(A.a)(n);function n(e){var r;return Object(d.a)(this,n),(r=t.call(this,e)).state=Object.assign(r.state,{editMode:!1}),r.saveHandler=[],r}return Object(b.a)(n,[{key:"saveEdit",value:function(){this.saveHandler.forEach((function(e){return e()})),this.setState({editMode:!1})}},{key:"addSaveEditHandler",value:function(e){this.saveHandler.push(e)}},{key:"render",value:function(){var e=this,t=this.props.shoppingStore,n=t.currentShoppingList,r=t.currentShoppingListItemsArray,a=t.initializationDone,s=function(){return!e.state.editMode&&i.a.createElement(x.e,{color:"danger",fill:"clear","data-test":"btn-edit-list",onClick:function(){return e.setState({editMode:!0})}},i.a.createElement("span",{className:"hide-sm-down"},i.a.createElement(G.a,null,"Edit")),i.a.createElement(x.u,{slot:"end",icon:te.n}))},o=function(){return e.state.editMode&&i.a.createElement(x.e,{color:"danger",fill:"clear","data-test":"btn-save-list",onClick:function(){return e.saveEdit()}},i.a.createElement("span",{className:"hide-sm-down"},i.a.createElement(G.a,null,"Save")),i.a.createElement(x.u,{slot:"end",icon:te.F}))};return i.a.createElement(x.D,null,i.a.createElement(x.t,null,i.a.createElement(x.R,null,i.a.createElement(x.O,null,i.a.createElement(ft,{shoppingList:n}),i.a.createElement(ht,{list:n,slot:""}),"\xa0",i.a.createElement(mt,{list:n})),i.a.createElement(x.f,{slot:"primary"},i.a.createElement(s,null),i.a.createElement(o,null)),i.a.createElement(x.f,{slot:"secondary"},i.a.createElement(dt,{label:"All Shopping Lists",href:"/shopping-lists"})))),i.a.createElement(x.n,null,i.a.createElement(x.t,{collapse:"condense"},i.a.createElement(x.R,null,i.a.createElement(x.O,{size:"large"},i.a.createElement(ft,{shoppingList:n}),i.a.createElement(ht,{list:n,slot:""}),"\xa0",i.a.createElement(mt,{list:n})))),this.props.sessionStore.dbAuthenticated&&i.a.createElement(at,{model:this,editMode:this.state.editMode,addSaveEditHandler:this.addSaveEditHandler.bind(this)})),i.a.createElement(x.r,null,a&&i.a.createElement(pt,{model:this,hasItems:r&&r.length})))}}]),n}(Re),bt=Object(U.a)(P,pe,Object(o.b)("shoppingStore","userStore","sessionStore"),o.c)(gt),Et=function(e){Object(N.a)(n,e);var t=Object(A.a)(n);function n(e){var r;return Object(d.a)(this,n),(r=t.call(this,e)).statusTransitionTriggered=!1,r}return Object(b.a)(n,[{key:"componentDidUpdate",value:function(){!this.statusTransitionTriggered&&this.props.shoppingStore.currentShoppingList&&(this.props.model.onGoShopping(this.props.shoppingStore.currentShoppingList),this.statusTransitionTriggered=!0)}},{key:"render",value:function(){var e=this.props,t=e.shoppingStore,n=e.sessionStore,r=t.currentShoppingList,a=t.currentShoppingListItemsArray,s=t.currentDependentNeedsListsArray,o=t.currentDependentNeedsListsItemsArray,c=t.initializationDone;return c?r&&i.a.createElement(i.a.Fragment,null,i.a.createElement(Xe,{authUser:n.authUser,list:r,items:a,mode:Be,dependentNeedLists:s,bringAlongItems:o,onCreateItem:this.props.model.onCreateItemForCurrentShoppingList,onEditItem:this.props.model.onEditShoppingItem,onShopItem:this.props.model.onShopShoppingItem,onDeleteItem:this.props.model.onRemoveShoppingItem,onReorderItems:this.props.model.onReorderItems})):i.a.createElement(et,{loading:c})}}]),n}(r.Component),St=Object(U.a)(_.i,Object(o.b)("shoppingStore","sessionStore"),o.c)(Et),yt=Object(_.i)((function(){return i.a.createElement(x.p,{fill:"clear",href:"/finish-shopping"},i.a.createElement(x.u,{icon:te.C}))})),vt=function(e){Object(N.a)(n,e);var t=Object(A.a)(n);function n(){return Object(d.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"render",value:function(){var e=this.props.shoppingStore.currentShoppingList;return i.a.createElement(x.D,null,i.a.createElement(x.t,null,i.a.createElement(x.R,null,i.a.createElement(x.O,null,i.a.createElement(ht,{list:e}),"\xa0",i.a.createElement(mt,{list:e})),i.a.createElement(x.f,{slot:"primary"}),i.a.createElement(x.f,{slot:"secondary"},i.a.createElement(re,{defaultHref:V})))),i.a.createElement(x.n,null,i.a.createElement(x.t,{collapse:"condense"},i.a.createElement(x.R,null,i.a.createElement(x.O,{size:"large"},i.a.createElement(ht,{list:e}),"\xa0",i.a.createElement(mt,{list:e})))),this.props.sessionStore.dbAuthenticated&&i.a.createElement(St,{model:this})),i.a.createElement(x.r,null,e&&i.a.createElement(x.o,{vertical:"bottom",horizontal:"end"},i.a.createElement(yt,null))))}}]),n}(Re),Lt=Object(U.a)(P,pe,Object(o.b)("shoppingStore","userStore","sessionStore"),o.c)(vt),Ot=function(e){Object(N.a)(n,e);var t=Object(A.a)(n);function n(e){var r;return Object(d.a)(this,n),(r=t.call(this,e)).onToggleEditMode=function(){r.setState((function(e){return{editMode:!e.editMode,editText:r.props.list.name}}))},r.onChangeEditText=function(e){r.setState({editText:e.target.value})},r.onSaveEditText=function(){r.props.onEditNeedsList(r.props.list,r.state.editText),r.setState({editMode:!1})},r.state={editMode:!1,editText:""},r}return Object(b.a)(n,[{key:"render",value:function(){var e=this.props,t=e.list,n=e.ownList,r=e.items,a=e.mode,s=e.onCreateItem,o=e.onEditItem,c=e.onDeleteItem;return i.a.createElement(x.A,null,(r||[]).map((function(e,r){return i.a.createElement(Ze,{key:e.id||r,item:e,onEditingConcluded:o,onDeleteItem:c,onCreateNeed:s,mode:a,ownList:n,readOnly:t&&"open"!==t.lifecycleStatus})})))}}]),n}(r.Component),It=function(e){Object(N.a)(n,e);var t=Object(A.a)(n);function n(e){var r;return Object(d.a)(this,n),(r=t.call(this,e)).statusTransitionTriggered=!1,r}return Object(b.a)(n,[{key:"componentDidUpdate",value:function(){!this.statusTransitionTriggered&&this.props.shoppingStore.currentShoppingList&&(this.props.model.onFinishShopping(this.props.shoppingStore.currentShoppingList),this.statusTransitionTriggered=!0)}},{key:"render",value:function(){var e=this,t=this.props.shoppingStore,n=t.currentShoppingList,r=t.currentShoppingListItemsArray,a=t.currentDependentNeedsListsArray,s=t.currentDependentNeedsListsItemsArray,o=t.initializationDone;return o?n&&i.a.createElement(x.A,null,i.a.createElement(x.B,{lines:"inset"},i.a.createElement(x.y,null,i.a.createElement("h1",null,i.a.createElement(G.a,null,"My own shopped items")))),i.a.createElement(Xe,{key:n.userId,list:n,items:r.filter((function(e){return!!e.shopped})),ownList:!1,mode:qe}),a&&a.map((function(t){var n=s.filter((function(e){return!!e.shopped&&e.ownerId===t.userId}));if(!n.length)return null;var r=e.props.userStore.users[t.userId];return i.a.createElement(i.a.Fragment,null,i.a.createElement(x.x,{key:t.userId},r&&i.a.createElement(i.a.Fragment,null,i.a.createElement(Je,{user:r,size:"50px",slot:"end"}),i.a.createElement(x.y,null,i.a.createElement("h1",null,i.a.createElement(G.a,null,"For"),"\xa0",r.username)))),i.a.createElement(Ot,{list:t,items:n,ownList:!1,mode:He}))}))):i.a.createElement(et,{loading:o})}}]),n}(r.Component),jt=Object(U.a)(_.i,Object(o.b)("shoppingStore","userStore"),o.c)(It),wt=function(e){var t=e.currentShoppingList,n=e.onArchiveShoppingList,r=e.history;return t?i.a.createElement(x.p,{onClick:function(){n(t),r.push(V)}},i.a.createElement(x.u,{icon:te.f})):null},Ct=function(e){Object(N.a)(n,e);var t=Object(A.a)(n);function n(){return Object(d.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"render",value:function(){return i.a.createElement(x.D,null,i.a.createElement(x.t,null,i.a.createElement(x.R,null,i.a.createElement(x.f,{slot:"start"},i.a.createElement(re,{defaultHref:"/go-shopping"})),i.a.createElement(x.O,null,i.a.createElement(G.a,null,"Finish shopping")))),i.a.createElement(x.n,null,this.props.sessionStore.dbAuthenticated&&i.a.createElement(jt,{model:this})),i.a.createElement(x.r,null,i.a.createElement(x.o,{vertical:"bottom",horizontal:"end"},i.a.createElement(wt,{currentShoppingList:this.props.shoppingStore.currentShoppingList,onArchiveShoppingList:this.onArchiveShoppingList,history:this.props.history}))))}}]),n}(Re),kt=Object(U.a)(P,pe,_.i,Object(o.b)("shoppingStore","userStore","sessionStore"),o.c)(Ct),Nt=Object(_.i)((function(e){return i.a.createElement(x.A,null,e.lists&&e.lists.filter((function(t){return!!e.includeArchived||"archived"!==t.lifecycleStatus})).map((function(t){return i.a.createElement(x.x,{key:t.uid,"data-test":"list",onClick:function(){e.onSetCurrentList(t),e.history.push(e.hrefOnClick)}},i.a.createElement(x.y,null,i.a.createElement(mt,{list:t}),i.a.createElement("br",null),t&&t.createdAt&&i.a.createElement("span",{style:{fontSize:"0.7em"}},i.a.createElement(G.a,null,"Created on"),"\xa0",new Date(1e3*t.createdAt.seconds).toLocaleDateString())),i.a.createElement(ht,{list:t,slot:"start",defaultIcon:te.o}),"archived"!==t.lifecycleStatus&&i.a.createElement(x.e,{slot:"end",color:"danger","data-test":"btn-delete-list",size:"large",fill:"clear",onClick:function(){e.onRemoveList(t)}},i.a.createElement(x.u,{icon:te.K})))})))})),At=function(e){var t=e.onCreateShoppingList,n=e.history;return i.a.createElement(x.p,{onClick:function(){t(),n.push(V)}},i.a.createElement(x.u,{icon:te.b}))},xt=function(e){Object(N.a)(n,e);var t=Object(A.a)(n);function n(e){var r;return Object(d.a)(this,n),(r=t.call(this,e)).state=Object(g.a)({},r.state,{includeArchived:!1}),r}return Object(b.a)(n,[{key:"render",value:function(){var e=this;return i.a.createElement(x.D,null,i.a.createElement(x.t,null,i.a.createElement(x.R,null,i.a.createElement(x.f,{slot:"start"},i.a.createElement(re,{defaultHref:V})),i.a.createElement(x.x,{lines:"none",slot:"end"},i.a.createElement(x.y,null,i.a.createElement(G.a,null,"Include archived")),i.a.createElement(x.Q,{checked:this.state.includeArchived,onIonChange:function(t){return e.setState({includeArchived:t.detail.checked})}})))),i.a.createElement(x.n,null,this.props.sessionStore.dbAuthenticated&&i.a.createElement(Nt,{lists:this.props.shoppingStore.shoppingListsArray,onSetCurrentList:function(t){return e.onSetCurrentShoppingList(t.uid)},onRemoveList:function(t){return e.onArchiveShoppingList(t,!1)},includeArchived:this.state.includeArchived,hrefOnClick:V})),i.a.createElement(x.r,null,i.a.createElement(x.o,{vertical:"bottom",horizontal:"end"},i.a.createElement(At,{onCreateShoppingList:this.onCreateShoppingList,history:this.props.history}))))}}]),n}(Re),Dt=Object(U.a)(P,pe,_.i,Object(o.b)("shoppingStore","userStore","sessionStore"),o.c)(xt),_t=function(e){Object(N.a)(n,e);var t=Object(A.a)(n);function n(e){var r;return Object(d.a)(this,n),(r=t.call(this,e)).onListenForNeedsLists=function(){r.unsubscribeLists=r.props.firebase.myNeedsLists().orderBy("createdAt","desc").onSnapshot((function(e){var t=null,n=null;if(r.props.needsStore.setInitializationDone(!0),e.size){var i=[];e.forEach((function(e){var a=e.data();i.push(Object(g.a)({},a,{uid:e.id})),a.isCurrent&&a.shoppingListId&&(t=e.id,n=a.shoppingListId);var s=a.shoppingListOwnerId;s&&!r.props.userStore.users[s]&&r.props.firebase.user(s).get().then((function(e){var t=e.data();r.props.userStore.setUser(e.id,t)}))})),r.props.needsStore.setNeedsLists(i),r.setState(Object.assign(r.state,{listsLoading:!1}))}else r.props.needsStore.setNeedsLists([]),r.setState({listsLoading:!1,itemsLoading:!1});r.unsubscribeItems&&r.unsubscribeItems(),t&&r.onListenForCurrentNeedsListItems(t),r.unsubscribeOriginShoppingList&&r.unsubscribeOriginShoppingList(),r.unsubscribeOriginShoppingListItems&&r.unsubscribeOriginShoppingListItems(),n?r.unsubscribeOriginShoppingList=r.onListenForOriginShoppingList(n):r.clearOriginShoppingListInStore()}))},r.onListenForCurrentNeedsListItems=function(e){r.unsubscribeItems=r.props.firebase.listItems(e).onSnapshot((function(e){if(e.size){var t=[];e.forEach((function(e){return t.push(Object(g.a)({},e.data(),{uid:e.id,parentId:e.ref.parent.parent.id}))})),r.props.needsStore.setCurrentNeedsListItems(t),r.setState(Object.assign(r.state,{itemsLoading:!1}))}else r.props.needsStore.setCurrentNeedsListItems([]),r.setState({itemsLoading:!1})}))},r.onListenForOriginShoppingList=function(e){r.unsubscribeOriginShoppingList=r.props.firebase.list(e).onSnapshot((function(t){if(t.exists){var n=t.data();r.props.needsStore.setCurrentOriginShoppingList(n),r.unsubscribeOriginShoppingListItems&&r.unsubscribeOriginShoppingListItems(),r.onListenForOriginShoppingListItems(e)}else r.clearOriginShoppingListInStore()}))},r.onListenForOriginShoppingListItems=function(e){r.unsubscribeOriginShoppingListItems=r.props.firebase.listItems(e).onSnapshot((function(e){if(e.size){var t=[];e.forEach((function(e){return t.push(Object(g.a)({},e.data(),{uid:e.id}))})),r.props.needsStore.setCurrentOriginShoppingListItems(t)}else r.props.needsStore.setCurrentOriginShoppingListItems([])}))},r.onChangeText=function(e){r.setState({editingListName:e.target.value})},r.onCreateNeedsList=function(e){e.preventDefault(),r.props.firebase.createNeedsList({name:r.state.editingListName}),r.setState({editingListName:""})},r.onEditNeedsList=function(e,t){e.uid;var n=Object(Me.a)(e,["uid"]);r.props.firebase.editList(e.uid,Object(g.a)({},n,{name:t}))},r.onArchiveNeedsList=function(e){r.props.firebase.archiveNeedsList(e)},r.onRemoveNeedsList=function(e){r.props.firebase.deleteList(e)},r.onSetCurrentNeedsList=function(e){r.props.firebase.setCurrentNeedsList(e)},r.onCreateItemForCurrentNeedsList=function(e,t){var n=t.name,i=t.quantity,a=void 0===i?"":i,s=t.unit,o=void 0===s?"":s,c=r.props.needsStore.currentNeedsList;c?r.props.firebase.addNeededItemFromShoppingListItem(c.uid,e,{name:n,quantity:a,unit:o}):console.error("Cannot create item for non-existing needsList")},r.onEditNeededItem=function(e){var t=r.props.needsStore.currentNeedsList;t?r.props.firebase.editItem(t.uid,e):console.error("Cannot edit item in non-existing needsList")},r.onRemoveNeededItem=function(e){var t=r.props.needsStore.currentNeedsList;t?r.props.firebase.listItem(t.uid,e).delete():console.error("Cannot remove item from non-existing needsList")},r.onAddFromShoppingListItem=function(e){var t=r.props.needsStore.currentNeedsList;t?r.props.firebase.addNeededItemFromShoppingListItem(t.uid,Object.assign(e,{quantity:0})):console.error("Cannot add item to non-existing needsList")},r.state={listsLoading:!1,itemsLoading:!1},r}return Object(b.a)(n,[{key:"_tryInitialization",value:function(){this.props.sessionStore.dbAuthenticated&&!this.unsubscribeLists&&this.onListenForNeedsLists()}},{key:"componentDidMount",value:function(){this.props.needsStore.needsListsArray.length||this.setState({listsLoading:!0,itemsLoading:!0}),this._tryInitialization()}},{key:"componentDidUpdate",value:function(){this._tryInitialization()}},{key:"componentWillUnmount",value:function(){this.unregisterAllListeners()}},{key:"unregisterAllListeners",value:function(){this.unsubscribeLists&&this.unsubscribeLists(),this.unsubscribeItems&&this.unsubscribeItems(),this.unsubscribeOriginShoppingList&&this.unsubscribeOriginShoppingList(),this.unsubscribeOriginShoppingListItems&&this.unsubscribeOriginShoppingListItems()}},{key:"clearOriginShoppingListInStore",value:function(){this.props.needsStore.setCurrentOriginShoppingList(null),this.props.needsStore.setCurrentOriginShoppingListItems([])}}]),n}(r.Component),Ut={name:"",quantity:"",unit:""},Ft=function(e){Object(N.a)(n,e);var t=Object(A.a)(n);function n(e){var r;return Object(d.a)(this,n),(r=t.call(this,e)).state={editingListName:"",itemInCreation:Object(g.a)({},Ut)},r}return Object(b.a)(n,[{key:"onCreatingItemChange",value:function(e){this.setState({itemInCreation:Object.assign(this.state.itemInCreation,Object(E.a)({},e.target.name,e.target.value))})}},{key:"onCreateComplete",value:function(e){e.name&&e.quantity&&(this.props.model.onCreateItemForCurrentNeedsList(this.state.itemInCreation,e),this.setState({itemInCreation:Object(g.a)({},Ut)}))}},{key:"copyPotentialNeed",value:function(e){var t=e.unit&&e.quantity>=100?100:1;this.props.model.onCreateItemForCurrentNeedsList(e,Object.assign(e,{quantity:t}))}},{key:"render",value:function(){var e=this,t=this.props,n=t.needsStore,r=t.sessionStore,a=n.currentNeedsList,s=n.potentiallyNeededItemsArray,o=n.currentNeedsListItemsArray,c=n.currentOriginShoppingList,l=n.initializationDone,u=this.state.itemInCreation,p=u&&u.name,d=a&&"open"===a.lifecycleStatus&&(p||c&&c.allowCreateOwnNeeds)&&i.a.createElement(x.A,null,i.a.createElement(x.x,{key:"createItem"},i.a.createElement(rt,{item:u,onChange:this.onCreatingItemChange.bind(this),onEditingConcluded:this.onCreateComplete.bind(this),highlight:p,mode:He}))),m=c&&!c.allowCreateOwnNeeds&&"open"===c.lifecycleStatus&&i.a.createElement(x.x,{color:"warning",className:"permanent-message"},i.a.createElement(x.N,null,i.a.createElement(G.a,null,"Creating_own_items_disabled"))),h=function(){return i.a.createElement(x.s,null,i.a.createElement(x.H,null,i.a.createElement(x.m,null,i.a.createElement(x.x,null,i.a.createElement(Q,{maxWidth:"150px",textStart:"Nothing",textEnd:"SharedYet"})))))},f=function(e){var t=e.lifecycleStatus;if("open"===t)return null;var n={};return n.shopping=i.a.createElement(G.a,null,"Edit_not_possible_shopping"),n.finished=i.a.createElement(G.a,null,"Edit_not_possible_finished"),n.archived=i.a.createElement(G.a,null,"Edit_not_possible_archived"),i.a.createElement(x.x,{color:"warning",className:"permanent-message"},n[t])};return l?i.a.createElement(i.a.Fragment,null,c&&i.a.createElement(f,{lifecycleStatus:c.lifecycleStatus}),d,a&&i.a.createElement(Ot,{authUser:r.authUser,list:c,items:o,onCreateItem:this.props.model.onCreateItemForCurrentNeedsList,onEditItem:this.props.model.onEditNeededItem,onDeleteItem:this.props.model.onRemoveNeededItem,ownList:!0,mode:He}),!a&&i.a.createElement(h,null),c&&i.a.createElement(Ot,{authUser:r.authUser,list:c,items:s,onCreateItem:function(t){return e.copyPotentialNeed(t)},onEditItem:this.props.model.onEditNeededItem,onDeleteItem:this.props.model.onRemoveNeededItem,ownList:!1,mode:"potential"}),m):i.a.createElement(et,{loading:l})}}]),n}(r.Component),zt=Object(U.a)(Object(o.b)("needsStore","sessionStore"),o.c)(Ft),Pt=(n(78),function(e){Object(N.a)(n,e);var t=Object(A.a)(n);function n(){return Object(d.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"render",value:function(){var e=this.props.needsStore.currentNeedsList,t=function(t){var n=t.userStore,r=t.size;if(e&&n.users&&n.users[e.shoppingListOwnerId])return i.a.createElement(x.O,{size:r},i.a.createElement(ht,{list:e}),"\xa0",i.a.createElement(mt,{list:e}));return null};return i.a.createElement(x.D,null,i.a.createElement(x.t,null,i.a.createElement(x.R,null,i.a.createElement(t,{needsStore:this.props.needsStore,userStore:this.props.userStore,size:"medium"}),i.a.createElement(x.f,{slot:"secondary"},i.a.createElement(dt,{label:"All Needs Lists",href:"/needs-lists"})))),i.a.createElement(x.n,null,i.a.createElement(x.t,{collapse:"condense"},i.a.createElement(x.R,null,i.a.createElement(t,{needsStore:this.props.needsStore,userStore:this.props.userStore,size:"large"}))),this.props.sessionStore.dbAuthenticated&&i.a.createElement(zt,{model:this})))}}]),n}(_t)),Mt=Object(U.a)(P,pe,Object(J.a)(),Object(o.b)("needsStore","userStore","sessionStore"),o.c)(Pt),Rt=function(e){Object(N.a)(n,e);var t=Object(A.a)(n);function n(e){var r;return Object(d.a)(this,n),(r=t.call(this,e)).state=Object(g.a)({},r.state,{includeArchived:!1}),r}return Object(b.a)(n,[{key:"render",value:function(){var e=this;return i.a.createElement(x.D,null,i.a.createElement(x.t,null,i.a.createElement(x.R,null,i.a.createElement(x.f,{slot:"start"},i.a.createElement(re,{defaultHref:"/needs"})),i.a.createElement(x.x,{lines:"none",slot:"end"},i.a.createElement(x.y,null,i.a.createElement(G.a,null,"Include archived")),i.a.createElement(x.Q,{checked:this.state.includeArchived,onIonChange:function(t){return e.setState({includeArchived:t.detail.checked})}})))),i.a.createElement(x.n,null,this.props.sessionStore.dbAuthenticated&&i.a.createElement(Nt,{lists:this.props.needsStore.needsListsArray,onSetCurrentList:function(t){return e.onSetCurrentNeedsList(t.uid)},onRemoveList:function(t){return e.onArchiveNeedsList(t)},includeArchived:this.state.includeArchived,hrefOnClick:"/needs"})),i.a.createElement(x.r,null))}}]),n}(_t),Tt=Object(U.a)(P,pe,Object(o.b)("needsStore","userStore","sessionStore"),o.c)(Rt),qt=function(e){Object(N.a)(n,e);var t=Object(A.a)(n);function n(e){var r;return Object(d.a)(this,n),(r=t.call(this,e)).state={shoppingListId:null,sharedShoppingList:null,sharingUser:null,isValid:!1,loading:!0},r}return Object(b.a)(n,[{key:"componentDidMount",value:function(){var e=Object(q.a)(T.a.mark((function e(){var t,n,r,i,a,s;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.location,n=t.pathname,r=n.replace("/share/",""),e.next=5,this.props.firebase.list(r).get();case 5:if(i=e.sent,!(a=i.data())){e.next=13;break}return e.next=10,this.props.firebase.user(a.userId).get();case 10:e.t0=e.sent.data(),e.next=14;break;case 13:e.t0=null;case 14:s=e.t0,this.setState({shoppingListId:r,sharedShoppingList:a,sharingUser:s,isValid:i.exists,loading:!1});case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onCreateNeedsListForShoppingList",value:function(e,t){var n=this;this.props.firebase.createNeedsListForShoppingList(e,t).then((function(){n.props.history.push("/needs")}))}},{key:"render",value:function(){var e=this.state,t=e.loading,n=e.shoppingListId,r=e.sharingUser,a=e.isValid,s=function(e){return t?i.a.createElement(et,{loading:t}):t||a?!t&&a?i.a.createElement(i.a.Fragment,null,i.a.createElement(x.g,{style:{padding:"30px"}},i.a.createElement(x.h,{class:"ion-text-center"},i.a.createElement(Ne,{user:r,size:150}),i.a.createElement(x.j,null,r.username,"\xa0(",r.email,")"),i.a.createElement(x.i,null,i.a.createElement(G.a,null,"has shared a shopping list with you")))),i.a.createElement(x.r,null,i.a.createElement(Wt,Object.assign({},e,{shoppingListId:n,sharingUser:r})))):null:i.a.createElement("div",null,"The list with id ",n," does not exist")};return i.a.createElement(i.a.Fragment,null,i.a.createElement(x.D,null,i.a.createElement(x.t,null,i.a.createElement(x.R,null,i.a.createElement(x.O,null,i.a.createElement(G.a,null,"Shared")))),i.a.createElement(x.n,null,i.a.createElement(x.t,{collapse:"condense"},i.a.createElement(x.R,null,i.a.createElement(x.O,{size:"large"},i.a.createElement(G.a,null,"Shared")))),i.a.createElement(s,Object.assign({},this.props,{onCreateNeedsListForShoppingList:this.onCreateNeedsListForShoppingList.bind(this)})))))}}]),n}(r.Component),Wt=function(e){var t=e.shoppingListId,n=e.sharingUser,r=e.onCreateNeedsListForShoppingList;return i.a.createElement(x.e,{type:"button",expand:"block",onClick:function(){return r(t,n.username)}},i.a.createElement(G.a,null,"Open shared shopping list"))},Ht=Object(U.a)(P,pe,Object(o.b)("needsStore","sessionStore"),o.c)(qt),Bt=function(){return i.a.createElement(i.a.Fragment,null,i.a.createElement(x.M,null,i.a.createElement(x.G,null,i.a.createElement(_.c,{path:"/pw-forget",render:function(){return i.a.createElement(oe,null)}}),i.a.createElement(_.c,{path:"/pw-change",render:function(){return i.a.createElement(we,null)}}),i.a.createElement(_.c,{path:"/account",render:function(){return i.a.createElement(De,null)}}),i.a.createElement(_.c,{path:"/shopping-lists",render:function(){return i.a.createElement(Dt,null)}}),i.a.createElement(_.c,{path:V,render:function(){return i.a.createElement(bt,null)}}),i.a.createElement(_.c,{path:"/finish-shopping",render:function(){return i.a.createElement(kt,null)}}),i.a.createElement(_.c,{path:"/go-shopping",render:function(){return i.a.createElement(Lt,null)}}),i.a.createElement(_.c,{path:"/needs-lists",render:function(){return i.a.createElement(Tt,null)}}),i.a.createElement(_.c,{path:"/needs",render:function(){return i.a.createElement(Mt,null)}}),i.a.createElement(_.c,{path:"/share/:id",component:Ht}),i.a.createElement(_.c,{path:"/admin",render:function(){return i.a.createElement(Pe,null)}}),i.a.createElement(_.b,{exact:!0,from:"/signin",to:V}),i.a.createElement(_.b,{exact:!0,from:"/signup",to:V}),i.a.createElement(_.b,{exact:!0,from:"/",to:V})),i.a.createElement(x.K,{slot:"bottom"},i.a.createElement(x.L,{tab:"Shopping",href:V,"data-test":"tab-btn-shopping"},i.a.createElement(x.u,{icon:te.e}),i.a.createElement(x.y,null,i.a.createElement(G.a,null,"Shopping"))),i.a.createElement(x.L,{tab:"Needs",href:"/needs","data-test":"tab-btn-needs"},i.a.createElement(x.u,{icon:te.I}),i.a.createElement(x.y,null,i.a.createElement(G.a,null,"Shared"))),i.a.createElement(x.L,{tab:"Account",href:"/account","data-test":"tab-btn-account"},i.a.createElement(x.u,{icon:te.B}),i.a.createElement(x.y,null,i.a.createElement(G.a,null,"Account"))))))},Kt=function(){var e=Object(_.h)();return i.a.createElement(x.M,null,i.a.createElement(x.G,null,i.a.createElement(_.e,null,i.a.createElement(_.c,{path:"/signup",component:ee}),i.a.createElement(_.c,{path:"/signin",component:ve}),i.a.createElement(_.c,{path:"/pw-forget",render:function(){return i.a.createElement(oe,null)}}),i.a.createElement(_.b,{from:"/",to:{pathname:"/signin",state:{from:e}}}))),i.a.createElement(x.K,{slot:"bottom"},i.a.createElement(x.L,{tab:"Sign In",href:"/signin","data-test":"tab-btn-signin"},i.a.createElement(x.u,{icon:te.r}),i.a.createElement(x.y,null,"Sign In"))))},Vt=Object(U.a)(Object(o.b)("sessionStore"),o.c)((function(e){var t=e.sessionStore;return t.authUser?i.a.createElement(Bt,{authUser:t.authUser}):i.a.createElement(Kt,{authUser:t.authUser})})),Gt=(n(133),n(134),n(135),n(136),n(137),n(138),n(139),n(140),n(141),n(142),n(143),n(144),n(145),function(e){Object(N.a)(n,e);var t=Object(A.a)(n);function n(){return Object(d.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.handlerRegistered||(this.handlerRegistered=this.props.registerAuthListener((function(t){e.props.sessionStore.setDbAuthenticated(!!t)})))}},{key:"render",value:function(){return i.a.createElement(x.b,null,i.a.createElement(D.a,null,i.a.createElement(Vt,null)))}}]),n}(r.Component)),Jt=Object(U.a)(le,Object(o.b)("sessionStore"))(Gt),Qt=n(66),Zt=n(35),Yt=n(91);Qt.a.use(Yt.a).use(Zt.f).init({resources:{en:{translation:{"A shopping list has been shared with you":"A shopping list has been shared with you!",Account:"Account",Account_already_exists:"\n                An account with this E-Mail address already exists.\n                Try to login with this account instead. If you think the\n                account is already used from one of the social logins, try\n                to sign in with one of them. Afterward, associate your accounts\n                on your personal account page.\n                ","All Needs Lists":"Shared with me","All Shopping Lists":"My Shopping Lists","Allow friends to add own needs":"Allow friends to add own needs",archived:"archived",Back:"Back",by:"by","Change Password":"Change Password","Create Shopping List":"New Shopping List","Created on":"Created on",Creating_own_items_disabled:"The shopping list owner does not allow to add items which he does not shop anyway",Edit:"Edit",Edit_not_possible_shopping:"Editing ist not possible: It's currently being shopped! If you want to change something, better give the shopper a call ;)",Edit_not_possible_finished:"Editing ist not possible: Shopping has already been completed.",Edit_not_possible_archived:"Editing ist not possible: The shopping list has been archived.",Email:"Email",Email_confirmation_sent:"E-Mail confirmation sent: \n\n                Check you E-Mails (Spam folder included) for a confirmation E-Mail.\n\n                Refresh this page once you confirmed your E-Mail.",Email_verification_needed:"Verify your E-Mail: \n\n                Check you E-Mails (Spam folder included) for a confirmation E-Mail \n\n                or send another confirmation E-Mail.","Finish shopping":"Finish shopping",finished:"Shopping finished",For:"For","Forgot Password":"Forgot Password?","Full Name":"Full Name","Go Shopping":"Go shopping","has shared a shopping list with you":"has shared a shopping list with you","Include archived":"Include archived lists","Is confirmed. Reload":"Is confirmed. Reload","Item name":"Item",Items:"Items",Loading_message:"Loading...","My own shopped items":"My own shopped items",Name_mandatory:"Please enter what you want to shop!","Name of shopping list":"List name",Name_and_quantity_mandatory:"How much of what do you want to add to your cart?","No account yet?":"No account yet?","Open shared shopping list":"Open shared shopping list","or with":"or with",Password:"Password","Plan Shopping":"Plan Shopping",pwa_install_1:"Install ShareMyCart as app on your",pwa_install_2:"tap",pwa_install_3:'and then "Add to Home Screen"',Quantity:"Quantity","Reset My Password":"Reset My Password","Repeat Password":"Repeat Password",Save:"Save","Send confirmation E-Mail":"Send confirmation E-Mail",Share:"Share",Sharing_message:"Hi there! I'm about to go for shopping. Is there something on my shopping list which I shall bring along for you as well? Here's a link to my shopping list:",Sharing_link_copied:"A link to your shopping list has been copied to the clipboard.\nSend it to people you like so that they ask you to bring something along for you!",Sharing_link_received:"You received a link to a shared shopping list! Just sign-in or -up quickly to see what items your friend is going to shop!","Sign In":"Sign In","Sign Out":"Sign Out","Sign Up":"Sign Up",Shared:"Shared",shopping:"currently shopping",Shopping:"Shopping","Shopping list":"Shopping list",Username:"Username"}},de:{translation:{"A shopping list has been shared with you":"Ein Einkaufszettel wurde mit Dir geteilt!",Account:"Konto",Account_already_exists:"\n                Ein Konto mit dieser E-Mail-Adresse existiert bereits.\n\n                Versuche stattdessen, Dich mit diesem Konto anzumelden.\n\n                Wenn Du glaubst, dass das Konto bereits von einem der sozialen Logins aus verwendet wird, \n\n                versuche, Dich mit diesem anzumelden.\n\n                Danach verbinde Deine Konten auf Deiner pers\xf6nlichen Konto-Seite.\n                ","All Needs Lists":"Mit mir geteilt","All Shopping Lists":"Meine Einkaufszettel","Allow friends to add own needs":"Freunde k\xf6nnen neue Artikel erg\xe4nzen",archived:"archiviert",Back:"Zur\xfcck",by:"von","Change Password":"Passwort \xe4ndern","Create Shopping List":"Neuer Einkauszettel","Created on":"Angelegt am",Creating_own_items_disabled:"Der Eigent\xfcmer des Einkaufszettels erlaubt es nicht, dass Du weitere Artikel erg\xe4nzt",Edit:"Bearbeiten",Edit_not_possible_shopping:"Bearbeiten ist nicht mehr m\xf6glich: Es wird gerade eingekauft! Wenn Du noch etwas \xe4ndern m\xf6chtest, ruf lieber an ;)",Edit_not_possible_finished:"Bearbeiten ist nicht mehr m\xf6glich: Der Einkauf ist schon beendet!",Edit_not_possible_archived:"Bearbeiten ist nicht mehr m\xf6glich: Der Einkaufszettel wurde archiviert",Email:"Email",Email_confirmation_sent:"Best\xe4tigungs-E-Mail wurde gesendet: \n\n                Pr\xfcfe Deine E-Mails (inklusive des Spam-Ordners) f\xfcr eine Best\xe4tigungs-E-Mail.\n\n                Aktualisiere diese Seite, sobald Du Deine E-Mail best\xe4tigt hast.",Email_verification_needed:"Verifiziere Deine E-Mail-Adresse: \n\n                Pr\xfcfe Deine E-Mails (inklusive des Spam-Ordners) f\xfcr eine Best\xe4tigungs-E-Mail.\n\n                oder sende eine weitere E-Mail-Best\xe4tigungs-Anfrage.","Finish shopping":"Einkauf beenden",finished:"Einkauf beendet",For:"F\xfcr","Forgot Password":"Passwort vergessen?","Full Name":"Vollst\xe4ndiger Name","Go Shopping":"Einkaufen","has shared a shopping list with you":"hat einen Einkaufszettel mit Dir geteilt!",Help:"Hilfe","Include archived":"Auch archivierte anzeigen","Is confirmed. Reload":"Ist best\xe4tigt. Aktualisieren!","Item name":"Artikel",Items:"Artikel",Loading_message:"Ich lade...",Login:"Anmelden",Logout:"Abmelden","My own shopped items":"Meine eigenen Eink\xe4ufe",Name_mandatory:"Bitte gib an, was Du einkaufen m\xf6chtest!","Name of shopping list":"Name der Liste",Name_and_quantity_mandatory:"Was und wieviel soll es sein?","No account yet?":"Noch kein Konto?","Open shared shopping list":"Geteilten Einkaufszettel \xf6ffnen","or with":"oder mit",Password:"Passwort","Plan Shopping":"Einkauf planen",pwa_install_1:"Installiere ShareMyCart auf Deinem",pwa_install_2:"Klicke auf",pwa_install_3:'und dann auf "Zum Home-Bildschirm"',Quantity:"Menge","Repeat Password":"Passwort wiederholen","Reset My Password":"Mein Passwort zur\xfccksetzen",Save:"Speichern","Send confirmation E-Mail":"Best\xe4tigungs-E-Mail senden",Share:"Teilen","Sign In":"Anmelden","Sign Out":"Abmelden","Sign Up":"Anmelden",Shared:"Geteilt",Sharing_message:"Hallo! Ich gehe demn\xe4chst etwas einkaufen. \nSteht auf meinem Einkaufszettel etwas, das ich Dir auch mitbringen soll? Hier ist ein Link auf meinen Einkaufszettel:",Sharing_link_copied:"\n                Ein Link zu Deinem Einkaufszettel wurde in die Zwischenablage kopiert.\n\n                Schicke ihn an Leute, denen Du etwas, das ohnehin schon auf Deinem Zettel steht, mitbringen m\xf6chtest.\n                ",Sharing_link_received:"Ein Freund hat einen Einkaufszettel mit Dir geteilt! \nMelde Dich flott an, um zu erfahren, was drauf steht!",shopping:"wird eingekauft",Shopping:"Einkaufen","Shopping list":"Einkaufszettel",Username:"Benutzername"}}},fallbackLng:"en",debug:!0,keySeparator:!1,interpolation:{escapeValue:!1}});Qt.a;s.a.render(i.a.createElement(r.Fragment,null,i.a.createElement(o.a,k,i.a.createElement(M.Provider,{value:new K},i.a.createElement(Jt,null))),i.a.createElement(l.a,{showPwaInvitation:!0,iosInvitationTimeout:1e4,iosInvitationOnlySafari:!0,iosInvitationContent:function(e){return i.a.createElement(r.Fragment,null,i.a.createElement(G.a,null,"pwa_install_1")," ",e,": ",i.a.createElement("br",null),i.a.createElement(G.a,null,"pwa_install_2")," ",i.a.createElement(c.IconShareIos,null)," ",i.a.createElement(G.a,null,"pwa_install_3"))}})),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");u?(!function(e,t){fetch(e).then((function(n){var r=n.headers.get("content-type");404===n.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):p(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")}))):p(t,e)}))}}()},61:function(e,t,n){},77:function(e,t,n){},78:function(e,t,n){},94:function(e,t,n){e.exports=n(146)}},[[94,7,51]]]);
//# sourceMappingURL=main.7fbe5df6.chunk.js.map